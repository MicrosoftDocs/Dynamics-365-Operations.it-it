---
title: Esempio di integrazione di stampante fiscale per l'Italia
description: In questo argomento viene fornita una panoramica dell'esempio di integrazione fiscale per l'Italia.
author: josaw
manager: annbe
ms.date: 01/23/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.search.region: Italy
ms.search.industry: Retail
ms.author: sepism
ms.search.validFrom: 2018-11-1
ms.dyn365.ops.version: 8.1.1
ms.openlocfilehash: 92cfa6ace7a6bef2ce9ff0899ca7a60193738aa6
ms.sourcegitcommit: 68df883200b5c477ea1799cc28d3ef467cd29202
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/07/2019
ms.locfileid: "377265"
---
# <a name="fiscal-printer-integration-sample-for-italy"></a><span data-ttu-id="cd336-103">Esempio di integrazione di stampante fiscale per l'Italia</span><span class="sxs-lookup"><span data-stu-id="cd336-103">Fiscal printer integration sample for Italy</span></span>

[!include[banner](../includes/banner.md)]

## <a name="introduction"></a><span data-ttu-id="cd336-104">Introduzione</span><span class="sxs-lookup"><span data-stu-id="cd336-104">Introduction</span></span>

<span data-ttu-id="cd336-105">La funzionalità di Microsoft Dynamics 365 for Retail per l'Italia include un'integrazione di esempio del POS con una stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-105">The Microsoft Dynamics 365 for Retail functionality for Italy includes a sample integration of the point of sale (POS) with a fiscal printer.</span></span> <span data-ttu-id="cd336-106">L'esempio estende la [funzionalità di integrazione fiscale](fiscal-integration-for-retail-channel.md) di modo che sia utilizzabile con le stampanti [Epson FP-90III Series](http://www.epson.it/products/sd/pos-printer/epson-fp-90iii-series) di Epson e abilita la comunicazione con una stampante fiscale in modalità server Web via il servizio Web EpsonFPMate utilizzando l'API Fiscal ePOS-Print.</span><span class="sxs-lookup"><span data-stu-id="cd336-106">The sample extends the [fiscal integration functionality](fiscal-integration-for-retail-channel.md) so that it works with [Epson FP-90III Series](http://www.epson.it/products/sd/pos-printer/epson-fp-90iii-series) printers from Epson, and it enables communication with a fiscal printer in the web server mode via the EpsonFPMate web-service using Fiscal ePOS-Print API.</span></span> <span data-ttu-id="cd336-107">L'esempio supporta soltanto la modalità Registratore Telematico (RT).</span><span class="sxs-lookup"><span data-stu-id="cd336-107">The sample supports the Registratore Telematico (RT) mode only.</span></span> <span data-ttu-id="cd336-108">L'esempio viene fornito sotto forma di codice sorgente e fa parte del kit SDK.</span><span class="sxs-lookup"><span data-stu-id="cd336-108">The sample is provided in the form of source code and is part of the Retail software development kit (SDK).</span></span>

<span data-ttu-id="cd336-109">Microsoft non rilascia hardware, software o documentazione di Epson.</span><span class="sxs-lookup"><span data-stu-id="cd336-109">Microsoft doesn't release any hardware, software, or documentation from Epson.</span></span> <span data-ttu-id="cd336-110">Per informazioni su come ottenere la stampante fiscale e utilizzarla, contattare [Epson Italia S.p.A](http://www.epson.it).</span><span class="sxs-lookup"><span data-stu-id="cd336-110">For information about how to get the fiscal printer and operate it, contact [Epson Italia S.p.A](http://www.epson.it).</span></span>
 
## <a name="scenarios"></a><span data-ttu-id="cd336-111">Scenari</span><span class="sxs-lookup"><span data-stu-id="cd336-111">Scenarios</span></span>

<span data-ttu-id="cd336-112">Gli scenari seguenti sono coperti dall'esempio di integrazione di stampante fiscale per l'Italia:</span><span class="sxs-lookup"><span data-stu-id="cd336-112">The following scenarios are covered by the fiscal printer integration sample for Italy:</span></span>

- <span data-ttu-id="cd336-113">Scenari di vendita:</span><span class="sxs-lookup"><span data-stu-id="cd336-113">Sales scenarios:</span></span>

    - <span data-ttu-id="cd336-114">Stampare una ricevuta fiscale per le vendite cash and carry e i resi.</span><span class="sxs-lookup"><span data-stu-id="cd336-114">Print a fiscal receipt for cash-and-carry sales and returns.</span></span>
    - <span data-ttu-id="cd336-115">Ottenure una risposta dalla stampante fiscale e archiviarla nel database del canale.</span><span class="sxs-lookup"><span data-stu-id="cd336-115">Capture a response from the fiscal printer, and store it in the channel database.</span></span>
    - <span data-ttu-id="cd336-116">Imposte:</span><span class="sxs-lookup"><span data-stu-id="cd336-116">Taxes:</span></span>

        - <span data-ttu-id="cd336-117">Eseguire il mapping ai codici imposta (reparti) della stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-117">Map to the fiscal printer's tax codes (departments).</span></span>
        - <span data-ttu-id="cd336-118">Trasferire i dati fiscali mappati alla stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-118">Transfer mapped tax data to the fiscal printer.</span></span>
        - <span data-ttu-id="cd336-119">Stampare le imposte su una ricevuta fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-119">Print taxes on a fiscal receipt.</span></span>

    - <span data-ttu-id="cd336-120">Pagamenti:</span><span class="sxs-lookup"><span data-stu-id="cd336-120">Payments:</span></span>

        - <span data-ttu-id="cd336-121">Eseguire il mapping ai metodi di pagamento della stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-121">Map to the fiscal printer's methods of payment.</span></span>
        - <span data-ttu-id="cd336-122">Stampare i pagamenti su una ricevuta fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-122">Print payments on a fiscal receipt.</span></span>
        - <span data-ttu-id="cd336-123">Stampare le informazioni sulle modifiche.</span><span class="sxs-lookup"><span data-stu-id="cd336-123">Print change information.</span></span>

    - <span data-ttu-id="cd336-124">Stampare gli sconti riga</span><span class="sxs-lookup"><span data-stu-id="cd336-124">Print line discounts.</span></span>
    - <span data-ttu-id="cd336-125">Gift card:</span><span class="sxs-lookup"><span data-stu-id="cd336-125">Gift cards:</span></span>

        - <span data-ttu-id="cd336-126">Escludere una riga gift card emessa/ricaricata da una ricevuta fiscale per una vendita.</span><span class="sxs-lookup"><span data-stu-id="cd336-126">Exclude an issued/re-charged gift card line from a fiscal receipt for a sale.</span></span>
        - <span data-ttu-id="cd336-127">Stampare un pagamento che utilizza una gift card come metodo di pagamento normale.</span><span class="sxs-lookup"><span data-stu-id="cd336-127">Print a payment that uses a gift card as a regular method of payment.</span></span>

    - <span data-ttu-id="cd336-128">Stampare ricevute fiscali per operazioni di ordini cliente:</span><span class="sxs-lookup"><span data-stu-id="cd336-128">Print fiscal receipts for customer order operations:</span></span>

        - <span data-ttu-id="cd336-129">Una ricevuta fiscale non viene stampata per un deposito ordine cliente.</span><span class="sxs-lookup"><span data-stu-id="cd336-129">A fiscal receipt isn't printed for a customer order deposit.</span></span>
        - <span data-ttu-id="cd336-130">Stampare una ricevuta fiscale per righe di esecuzione di un ordine cliente ibrido.</span><span class="sxs-lookup"><span data-stu-id="cd336-130">Print a fiscal receipt for carry-out lines of a hybrid customer order.</span></span>
        - <span data-ttu-id="cd336-131">Stampare una ricevuta fiscale per l'operazione di prelievo per un ordine cliente.</span><span class="sxs-lookup"><span data-stu-id="cd336-131">Print a fiscal receipt for the pickup operation for a customer order.</span></span>
        - <span data-ttu-id="cd336-132">Stampare una ricevuta fiscale per un ordine di reso.</span><span class="sxs-lookup"><span data-stu-id="cd336-132">Print a fiscal receipt for a return order.</span></span>

    - <span data-ttu-id="cd336-133">Stampare un codice a barre per il numero di ricevuta su una ricevuta fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-133">Print a barcode for the receipt number on a fiscal receipt.</span></span>

- <span data-ttu-id="cd336-134">Rendiconti di riepilogo giornalieri (report X e Z fiscali).</span><span class="sxs-lookup"><span data-stu-id="cd336-134">End of day statements (fiscal X and fiscal Z reports).</span></span>
- <span data-ttu-id="cd336-135">Gestione degli errori, ad esempio le seguenti opzioni:</span><span class="sxs-lookup"><span data-stu-id="cd336-135">Error handling, such as the following options:</span></span>

    - <span data-ttu-id="cd336-136">Se possibile, ripetere la registrazione fiscale nel caso la stampante fiscale non sia collegata, pronta o non risponda o se la carta risulta mancante o inceppata.</span><span class="sxs-lookup"><span data-stu-id="cd336-136">Retry fiscal registration if a retry is possible, such as if the fiscal printer isn't connected, isn't ready or isn't responding, the printer is out of paper, or there is a paper jam.</span></span>
    - <span data-ttu-id="cd336-137">Posticipare la registrazione fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-137">Postpone fiscal registration.</span></span>
    - <span data-ttu-id="cd336-138">Ignorare la registrazione fiscale, o contrassegnare la transazione come registrata, e includere i codici informativi per acquisire il motivo dell'errore e ulteriori informazioni.</span><span class="sxs-lookup"><span data-stu-id="cd336-138">Skip fiscal registration, or mark the transaction as registered, and include info codes to capture the reason for the failure and additional information.</span></span>

### <a name="default-data-mapping"></a><span data-ttu-id="cd336-139">Mapping dei dati predefiniti</span><span class="sxs-lookup"><span data-stu-id="cd336-139">Default data mapping</span></span>

<span data-ttu-id="cd336-140">Il mapping dei dati predefiniti seguente è incluso nella configurazione di fornitore di documenti fiscali fornita nell'esempio di integrazione fiscale:</span><span class="sxs-lookup"><span data-stu-id="cd336-140">The following default data mapping is included in the fiscal document provider configuration that is provided as part of the fiscal integration sample:</span></span>

- <span data-ttu-id="cd336-141">Mapping delle aliquote IVA:</span><span class="sxs-lookup"><span data-stu-id="cd336-141">Value-added tax (VAT) rates mapping:</span></span>

    <span data-ttu-id="cd336-142">*1 : 21.00 ; 2 : 10.00 ; 3 : 4.00 ; 4 : 0.00*</span><span class="sxs-lookup"><span data-stu-id="cd336-142">*1 : 21.00 ; 2 : 10.00 ; 3 : 4.00 ; 4 : 0.00*</span></span>

- <span data-ttu-id="cd336-143">Mapping del tipo di metodo di pagamento:</span><span class="sxs-lookup"><span data-stu-id="cd336-143">Tender type mapping:</span></span>

    <span data-ttu-id="cd336-144">*1 : 0 ; 2 : 1 ; 3 : 2 ; 4 : 2 ; 5 : 0 ; 6 : 0 ; 7 : 0 ; 8 : 2 ; 9 : 0 ; 10 : 2 ; 11 : 1*</span><span class="sxs-lookup"><span data-stu-id="cd336-144">*1 : 0 ; 2 : 1 ; 3 : 2 ; 4 : 2 ; 5 : 0 ; 6 : 0 ; 7 : 0 ; 8 : 2 ; 9 : 0 ; 10 : 2 ; 11 : 1*</span></span>

### <a name="gift-card-handling"></a><span data-ttu-id="cd336-145">Gestione di gift card</span><span class="sxs-lookup"><span data-stu-id="cd336-145">Gift card handling</span></span>

<span data-ttu-id="cd336-146">L'esempio di integrazione della stampante fiscale implementa le seguenti regole relative alle gift card:</span><span class="sxs-lookup"><span data-stu-id="cd336-146">The fiscal printer integration sample implements the following rules that are related to gift cards:</span></span>

- <span data-ttu-id="cd336-147">Escludere le righe di vendita correlate alle operazioni *Emetti gift card* e *Aggiungi a gift card* della ricevuta fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-147">Exclude sales lines that are related to the *Issue gift card* and *Add to gift card* operations from the fiscal receipt.</span></span>
- <span data-ttu-id="cd336-148">Non stampare una ricevuta fiscale se comporta soltanto righe gift card.</span><span class="sxs-lookup"><span data-stu-id="cd336-148">Don't print a fiscal receipt if it consists only of gift card lines.</span></span>
- <span data-ttu-id="cd336-149">Dedurre l'importo totale delle gift card emesse o ricaricate in una transazione dalle righe di pagamento della ricevuta fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-149">Deduct the total amount of gift cards that are issued or re-charged in a transaction from payment lines of the fiscal receipt.</span></span>
- <span data-ttu-id="cd336-150">Salvare le rettifiche calcolate delle righe di pagamento nel database del canale con un riferimento a una transazione fiscale corrispondente.</span><span class="sxs-lookup"><span data-stu-id="cd336-150">Save calculated adjustments of payment lines in the channel database with a reference to a corresponding fiscal transaction.</span></span>
- <span data-ttu-id="cd336-151">Il pagamento tramite gift card è considerato un pagamento normale.</span><span class="sxs-lookup"><span data-stu-id="cd336-151">Payment by gift card is considered a regular payment.</span></span>

### <a name="customer-deposits-and-customer-order-deposits"></a><span data-ttu-id="cd336-152">Depositi cliente e depositi ordine cliente</span><span class="sxs-lookup"><span data-stu-id="cd336-152">Customer deposits and customer order deposits</span></span>

<span data-ttu-id="cd336-153">L'esempio di integrazione della stampante fiscale implementa le seguenti regole relative a depositi cliente e a depositi ordine cliente:</span><span class="sxs-lookup"><span data-stu-id="cd336-153">The fiscal printer integration sample implements the following rules that are related to customer deposits and customer order deposits:</span></span>

- <span data-ttu-id="cd336-154">Non stampare una ricevuta fiscale se una transazione è un deposito cliente.</span><span class="sxs-lookup"><span data-stu-id="cd336-154">Don't print a fiscal receipt if a transaction is a customer deposit.</span></span>
- <span data-ttu-id="cd336-155">Non stampare una ricevuta fiscale se una transazione contiene solo un deposito ordine cliente o un rimborso di deposito ordine cliente.</span><span class="sxs-lookup"><span data-stu-id="cd336-155">Don't print a fiscal receipt if a transaction contains only a customer order deposit or a customer order deposit refund.</span></span>
- <span data-ttu-id="cd336-156">Stampare l'importo del deposito pagato in precedenza su una ricevuta fiscale per un'operazione di prelievo ordine cliente.</span><span class="sxs-lookup"><span data-stu-id="cd336-156">Print the amount of the previously paid deposit on a fiscal receipt for a customer order pickup operation.</span></span>
- <span data-ttu-id="cd336-157">Dedurre l'importo del deposito ordine cliente dalle righe di pagamento quando si crea un ordine cliente ibrido.</span><span class="sxs-lookup"><span data-stu-id="cd336-157">Deduct the customer order deposit amount from payment lines when a hybrid customer order is created.</span></span>
- <span data-ttu-id="cd336-158">Salvare le rettifiche calcolate delle righe di pagamento nel database del canale con un riferimento a una transazione fiscale per un ordine cliente ibrido.</span><span class="sxs-lookup"><span data-stu-id="cd336-158">Save calculated adjustments of payment lines in the channel database with a reference to a fiscal transaction for a hybrid customer order.</span></span>

## <a name="set-up-retail-for-italy"></a><span data-ttu-id="cd336-159">Impostazione vendita al dettaglio per l'Italia</span><span class="sxs-lookup"><span data-stu-id="cd336-159">Set up Retail for Italy</span></span>

### <a name="enable-extensions"></a><span data-ttu-id="cd336-160">Abilitare le estensioni</span><span class="sxs-lookup"><span data-stu-id="cd336-160">Enable extensions</span></span>

##### <a name="commerce-runtime-extension-components"></a><span data-ttu-id="cd336-161">Componenti dell'estensione di Commerce Runtime</span><span class="sxs-lookup"><span data-stu-id="cd336-161">Commerce runtime extension components</span></span>

<span data-ttu-id="cd336-162">I componenti dell'estensione di Commerce Runtime sono inclusi in Retail SDK.</span><span class="sxs-lookup"><span data-stu-id="cd336-162">The Commerce runtime extension components are included in the Retail SDK.</span></span> <span data-ttu-id="cd336-163">Per completare le seguenti procedure, aprire la soluzione CRT, **CommerceRuntimeSamples.sln**, in **RetailSdk\\SampleExtensions\\CommerceRuntime**.</span><span class="sxs-lookup"><span data-stu-id="cd336-163">To complete the following procedures, open the CRT solution, **CommerceRuntimeSamples.sln**, under **RetailSdk\\SampleExtensions\\CommerceRuntime**.</span></span>

1. <span data-ttu-id="cd336-164">Individuare il progetto **Runtime.Extensions.DocumentProvider.EpsonFP90IIISample** e compilarlo.</span><span class="sxs-lookup"><span data-stu-id="cd336-164">Find the **Runtime.Extensions.DocumentProvider.EpsonFP90IIISample** project, and build it.</span></span>
1. <span data-ttu-id="cd336-165">Nella cartella **Extensions.DocumentProvider.EpsonFP90IIISample\\bin\\Debug**, trovare il file assembly **Contoso.Commerce.Runtime.DocumentProvider.EpsonFP90IIISample.dll**.</span><span class="sxs-lookup"><span data-stu-id="cd336-165">In the **Extensions.DocumentProvider.EpsonFP90IIISample\\bin\\Debug** folder, find the **Contoso.Commerce.Runtime.DocumentProvider.EpsonFP90IIISample.dll** assembly file.</span></span>
1. <span data-ttu-id="cd336-166">Copiare il file assembly alla cartella dell'estensione CRT:</span><span class="sxs-lookup"><span data-stu-id="cd336-166">Copy the assembly file to the CRT extensions folder:</span></span>

    - <span data-ttu-id="cd336-167">**Server Retail**: copiare l'assembly nella cartella **\\bin\\ext** nella posizione del sito del Server Retail Microsoft Internet Information Services (IIS).</span><span class="sxs-lookup"><span data-stu-id="cd336-167">**Retail Server:** Copy the assembly to the **\\bin\\ext** folder under the Microsoft Internet Information Services (IIS) Retail Server site location.</span></span>
    - <span data-ttu-id="cd336-168">**CRT locale su POS moderno**: copiare l'assembly nella cartella **\\ext** nella posizione del broker client CRT locale.</span><span class="sxs-lookup"><span data-stu-id="cd336-168">**Local CRT on Modern POS:** Copy the assembly to the **\\ext** folder under the local CRT client broker location.</span></span>

1. <span data-ttu-id="cd336-169">Individuare il file di configurazione di estensioni per il CRT:</span><span class="sxs-lookup"><span data-stu-id="cd336-169">Find the extensions configuration file for CRT:</span></span>

    - <span data-ttu-id="cd336-170">**Server Retail**: il file si chiama **commerceruntime.ext.config** e si trova nella cartella bin\\ext nella posizione del sito del Server Retail IIS.</span><span class="sxs-lookup"><span data-stu-id="cd336-170">**Retail Server:** The file is named **commerceruntime.ext.config**, and it's in the bin\\ext folder under the IIS Retail Server site location.</span></span>
    - <span data-ttu-id="cd336-171">**CRT locale sul POS moderno**: il file si chiama **CommerceRuntime.MPOSOffline.Ext.config** e si trova nella posizione del broker client CRT locale.</span><span class="sxs-lookup"><span data-stu-id="cd336-171">**Local CRT on Modern POS:** The file is named **CommerceRuntime.MPOSOffline.Ext.config**, and it's under the local CRT client broker location.</span></span>

1. <span data-ttu-id="cd336-172">Registrare la modifica CRT nel file di configurazione di estensioni.</span><span class="sxs-lookup"><span data-stu-id="cd336-172">Register the CRT change in the extensions configuration file.</span></span> <span data-ttu-id="cd336-173">Aggiungere **source="assembly" value="Contoso.Commerce.Runtime.DocumentProvider.EpsonFP90IIISample"**.</span><span class="sxs-lookup"><span data-stu-id="cd336-173">Add **source="assembly" value="Contoso.Commerce.Runtime.DocumentProvider.EpsonFP90IIISample"**.</span></span>
1. <span data-ttu-id="cd336-174">Riavviare il servizio vendita al dettaglio:</span><span class="sxs-lookup"><span data-stu-id="cd336-174">Restart the Retail service:</span></span>

    - <span data-ttu-id="cd336-175">**Server Retail**: riavviare il sito del servizio di vendita al dettaglio da Gestione IIS.</span><span class="sxs-lookup"><span data-stu-id="cd336-175">**Retail Server:** Restart the Retail service site from IIS Manager.</span></span>
    - <span data-ttu-id="cd336-176">**Broker client**: terminare il processo **dllhost.exe** in Gestione attività quindi riavviare il POS moderno.</span><span class="sxs-lookup"><span data-stu-id="cd336-176">**Client broker:** End the **dllhost.exe** process in Task Manager, and then restart Modern POS.</span></span>

##### <a name="hardware-station-extension-components"></a><span data-ttu-id="cd336-177">Componenti dell'estensione stazione hardware</span><span class="sxs-lookup"><span data-stu-id="cd336-177">Hardware station extension components</span></span>

<span data-ttu-id="cd336-178">I componenti dell'estensione stazione hardware sono inclusi in Retail SDK.</span><span class="sxs-lookup"><span data-stu-id="cd336-178">The Hardware station extension components are included in the Retail SDK.</span></span> <span data-ttu-id="cd336-179">Per completare le seguenti procedure, aprire la soluzione Stazione hardware, **HardwareStationSamples.sln**, in **RetailSdk\\SampleExtensions\\HardwareStation**.</span><span class="sxs-lookup"><span data-stu-id="cd336-179">To complete the following procedures, open the Hardware Station solution, **HardwareStationSamples.sln**, under **RetailSdk\\SampleExtensions\\HardwareStation**.</span></span>

1. <span data-ttu-id="cd336-180">Individuare il progetto **HardwareStation.Extensions.EpsonFP90IIIFiscalDeviceSample** e compilarlo.</span><span class="sxs-lookup"><span data-stu-id="cd336-180">Find the **HardwareStation.Extensions.EpsonFP90IIIFiscalDeviceSample** project, and build it.</span></span>
1. <span data-ttu-id="cd336-181">Nella cartella **Extensions.EpsonFP90IIIFiscalDeviceSample\\bin\\Debug**, trovare il file assembly **Contoso.Commerce.HardwareStation.EpsonFP90IIIFiscalDeviceSample.dll**.</span><span class="sxs-lookup"><span data-stu-id="cd336-181">In the **Extensions.EpsonFP90IIIFiscalDeviceSample\\bin\\Debug** folder, find the **Contoso.Commerce.HardwareStation.EpsonFP90IIIFiscalDeviceSample.dll** assembly file.</span></span>
1. <span data-ttu-id="cd336-182">Copiare i file in un computer stazione hardware distribuito:</span><span class="sxs-lookup"><span data-stu-id="cd336-182">Copy the files to a deployed Hardware station machine:</span></span>

    - <span data-ttu-id="cd336-183">**Stazione hardware remota**: copiare i file nella cartella **bin** nella posizione del sito stazione hardware IIS.</span><span class="sxs-lookup"><span data-stu-id="cd336-183">**Remote Hardware station:** Copy the files to the **bin** folder under the IIS Hardware station site location.</span></span>
    - <span data-ttu-id="cd336-184">**Stazione hardware locale**: copiare i file nella posizione del broker client POS moderno.</span><span class="sxs-lookup"><span data-stu-id="cd336-184">**Local Hardware station:** Copy the files to the Modern POS client broker location.</span></span>

1. <span data-ttu-id="cd336-185">Individuare il file di configurazione per le estensioni della stazione hardware.</span><span class="sxs-lookup"><span data-stu-id="cd336-185">Find the configuration file for the Hardware station's extensions.</span></span> <span data-ttu-id="cd336-186">Il file si chiama **HardwareStation.Extension.config**:</span><span class="sxs-lookup"><span data-stu-id="cd336-186">The file is named **HardwareStation.Extension.config**:</span></span>

    - <span data-ttu-id="cd336-187">**Stazione hardware remota**: il file si trova sotto la posizione del sito della stazione hardware IIS.</span><span class="sxs-lookup"><span data-stu-id="cd336-187">**Remote Hardware station:** The file is located under the IIS Hardware station site location.</span></span>
    - <span data-ttu-id="cd336-188">**Stazione hardware locale**: il file si trova nella posizione del broker client POS moderno.</span><span class="sxs-lookup"><span data-stu-id="cd336-188">**Local Hardware station:** The file is located under the Modern POS client broker location.</span></span>
    
1. <span data-ttu-id="cd336-189">Aggiungere la sezione seguente alla sezione di **composizione** del file di configurazione.</span><span class="sxs-lookup"><span data-stu-id="cd336-189">Add the following section to the **composition** section of the config file.</span></span>

    ```
    <add source="assembly" value="Contoso.Commerce.HardwareStation.Extension.EpsonFP90IIIFiscalDeviceSample" />
    ```

1. <span data-ttu-id="cd336-190">Riavviare il servizio della stazione hardware:</span><span class="sxs-lookup"><span data-stu-id="cd336-190">Restart the Hardware station service:</span></span>

    - <span data-ttu-id="cd336-191">**Stazione hardware remota**: Riavviare il sito della stazione hardware da Gestione IIS.</span><span class="sxs-lookup"><span data-stu-id="cd336-191">**Remote Hardware station:** Restart the Hardware station site from IIS Manager.</span></span>
    - <span data-ttu-id="cd336-192">**Stazione hardware locale**: terminare il processo **dllhost.exe** in Gestione attività quindi riavviare il POS moderno.</span><span class="sxs-lookup"><span data-stu-id="cd336-192">**Local Hardware station:** End the **dllhost.exe** process in Task Manager, and then restart Modern POS.</span></span>

### <a name="set-up-the-registration-process"></a><span data-ttu-id="cd336-193">Impostare il processo di registrazione</span><span class="sxs-lookup"><span data-stu-id="cd336-193">Set up the registration process</span></span>

<span data-ttu-id="cd336-194">Per abilitare il processo di registrazione, seguire questi passaggi per configurare Retail Headquarters:</span><span class="sxs-lookup"><span data-stu-id="cd336-194">To enable the registration process, follow these steps to set up Retail Headquarters.</span></span> <span data-ttu-id="cd336-195">Per ulteriori informazioni, vedere [Configurare un processo di registrazione fiscale](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span><span class="sxs-lookup"><span data-stu-id="cd336-195">For more details, see [Set up a fiscal registration process](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span></span>

1. <span data-ttu-id="cd336-196">Accedere a **Vendita al dettaglio \> Impostazione canale \> Integrazione fiscale \> Connettori fiscali**.</span><span class="sxs-lookup"><span data-stu-id="cd336-196">Go to **Retail \> Channel Setup \> Fiscal Integration \> Fiscal Connectors**.</span></span> <span data-ttu-id="cd336-197">Importare la configurazione da **RetailSdk\\SampleExtensions\\HardwareStation\\Entension.EpsonFP90IIIFiscalDeviceSample\\Configuration\\ConnectorEpsonFP90IIISample.xml**.</span><span class="sxs-lookup"><span data-stu-id="cd336-197">Import the configuration from **RetailSdk\\SampleExtensions\\HardwareStation\\Entension.EpsonFP90IIIFiscalDeviceSample\\Configuration\\ConnectorEpsonFP90IIISample.xml**.</span></span>
2. <span data-ttu-id="cd336-198">Accedere a **Vendita al dettaglio \> Impostazione canale \> Integrazione fiscale \> Fornitori di documenti fiscali**.</span><span class="sxs-lookup"><span data-stu-id="cd336-198">Go to **Retail \> Channel Setup \> Fiscal Integration \> Fiscal Document providers**.</span></span> <span data-ttu-id="cd336-199">Importare la configurazione da **RetailSdk\\SampleExtensions\\CommerceRuntime\\Entension.DocumentProvider.EpsonFP90IIISample\\Configuration\\DocumentProviderEpsonFP90IIISample.xml**.</span><span class="sxs-lookup"><span data-stu-id="cd336-199">Import the configuration from **RetailSdk\\SampleExtensions\\CommerceRuntime\\Entension.DocumentProvider.EpsonFP90IIISample\\Configuration\\DocumentProviderEpsonFP90IIISample.xml**.</span></span>
3. <span data-ttu-id="cd336-200">Accedere a **Vendita al dettaglio \> Impostazione canale \> Integrazione fiscale \> Profili tecnici del connettore**.</span><span class="sxs-lookup"><span data-stu-id="cd336-200">Go to **Retail \> Channel Setup \> Fiscal Integration \> Connector Technical profiles**.</span></span> <span data-ttu-id="cd336-201">Creare un nuovo profilo e selezionare il connettore caricato nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="cd336-201">Create a new profile, and select the loaded connector from the earlier step.</span></span> <span data-ttu-id="cd336-202">Aggiornare le impostazioni di connessione se un aggiornamento è necessario.</span><span class="sxs-lookup"><span data-stu-id="cd336-202">Update the connection settings if an update is required.</span></span>
4. <span data-ttu-id="cd336-203">Accedere a **Vendita al dettaglio \> Impostazione canale \> Integrazione fiscale \> Profili funzionali del connettore**.</span><span class="sxs-lookup"><span data-stu-id="cd336-203">Go to **Retail \> Channel Setup \> Fiscal Integration \> Connector Functional profiles**.</span></span> <span data-ttu-id="cd336-204">Creare un nuovo profilo e selezionare il connettore e il fornitore di documenti caricati nei passaggi precedenti.</span><span class="sxs-lookup"><span data-stu-id="cd336-204">Create a new profile, and select the loaded connector and document provider from the earlier steps.</span></span> <span data-ttu-id="cd336-205">Aggiornare le impostazioni di mapping dei dati se un aggiornamento è necessario.</span><span class="sxs-lookup"><span data-stu-id="cd336-205">Update data mapping settings if an update is required.</span></span>
5. <span data-ttu-id="cd336-206">Accedere a **Vendita al dettaglio \> Impostazione canale \> Integrazione fiscale \> Gruppo funzionale di connettori**.</span><span class="sxs-lookup"><span data-stu-id="cd336-206">Go to **Retail \> Channel Setup \> Fiscal Integration \> Connector Functional group**.</span></span> <span data-ttu-id="cd336-207">Creare un nuovo gruppo e selezionare il profilo funzionale del connettore del passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="cd336-207">Create a new group, and select the connector functional profile from the earlier step.</span></span>
6. <span data-ttu-id="cd336-208">Accedere a **Vendita al dettaglio \> Impostazione canale \> Integrazione fiscale \> Processo di registrazione**.</span><span class="sxs-lookup"><span data-stu-id="cd336-208">Go to **Retail \> Channel Setup \> Fiscal Integration \> Registration process**.</span></span> <span data-ttu-id="cd336-209">Creare un nuovo processo e selezionare il gruppo funzionale di connettori del passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="cd336-209">Create a new process, and select the connector functional group from the earlier step.</span></span>
7. <span data-ttu-id="cd336-210">Passare a **Vendita al dettaglio \> Impostazione canale \> Impostazioni POS \> Profili POS \> Profili funzionalità**.</span><span class="sxs-lookup"><span data-stu-id="cd336-210">Go to **Retail \> Channel setup \> POS setup \> POS profiles \> Functionality profiles**.</span></span> <span data-ttu-id="cd336-211">Aprire il profilo funzionalità collegato al punto vendita in cui il processo di registrazione deve essere attivato.</span><span class="sxs-lookup"><span data-stu-id="cd336-211">Open the functionality profile that is linked to the store where the registration process should be activated.</span></span> <span data-ttu-id="cd336-212">Nella scheda Dettaglio **Processo di registrazione fiscale**, selezionare il processo di registrazione creato nel passaggio precedente.</span><span class="sxs-lookup"><span data-stu-id="cd336-212">On the **Fiscal registration process** FastTab, select the created registration process from the earlier step.</span></span>
8. <span data-ttu-id="cd336-213">Passare a **Vendita al dettaglio \> Impostazione canale \> Impostazioni POS \> Profili POS \> Profili hardware**.</span><span class="sxs-lookup"><span data-stu-id="cd336-213">Go to **Retail \> Channel setup \> POS setup \> POS profiles \> Hardware profiles**.</span></span> <span data-ttu-id="cd336-214">Aprire il profilo hardware collegato alla stazione hardware a cui la stampante fiscale sarà collegata.</span><span class="sxs-lookup"><span data-stu-id="cd336-214">Open the hardware profile that is linked to the Hardware station that the fiscal printer will be connected to.</span></span> <span data-ttu-id="cd336-215">Nella scheda Dettaglio **Periferiche fiscali**, selezionare il profilo tecnico del connettore.</span><span class="sxs-lookup"><span data-stu-id="cd336-215">On the **Fiscal peripherals** FastTab, select the connector technical profile.</span></span>
9. <span data-ttu-id="cd336-216">Aprire la programmazione della distribuzione (**Vendita al dettaglio \> Vendita al dettaglio IT > Programmazione della distribuzione**) e selezionare il processo **1070** per trasferire i dati al database del canale.</span><span class="sxs-lookup"><span data-stu-id="cd336-216">Open the distribution schedule (**Retail \> Retail IT > Distribution schedule**), and select job **1070** to transfer data to the channel database.</span></span>

## <a name="commerce-runtime-extension-design"></a><span data-ttu-id="cd336-217">Progettazione dell'estensione di Commerce Runtime</span><span class="sxs-lookup"><span data-stu-id="cd336-217">Commerce runtime extension design</span></span>

<span data-ttu-id="cd336-218">Lo scopo dell'estensione (fornitore di documenti) è di generare documenti specifici per la stampante e di gestire le risposte dalla stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-218">The purpose of the extension (document provider) is to generate printer-specific documents and handle responses from the fiscal printer.</span></span>

<span data-ttu-id="cd336-219">Estensione di Commerce Runtime: **Runtime.Extensions.DocumentProvider.EpsonFP90IIISample**.</span><span class="sxs-lookup"><span data-stu-id="cd336-219">Commerce runtime extension: **Runtime.Extensions.DocumentProvider.EpsonFP90IIISample**.</span></span>

<span data-ttu-id="cd336-220">Per ulteriori informazioni sulla progettazione della soluzione di integrazione fiscale, vedere [Processo di registrazione fiscale ed esempi di integrazione fiscale per dispositivi fiscali](fiscal-integration-for-retail-channel.md#fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices).</span><span class="sxs-lookup"><span data-stu-id="cd336-220">For more details about the design of the fiscal integration solution, see [Fiscal registration process and fiscal integration samples for fiscal devices](fiscal-integration-for-retail-channel.md#fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices).</span></span>

### <a name="request-handler"></a><span data-ttu-id="cd336-221">Gestore richieste</span><span class="sxs-lookup"><span data-stu-id="cd336-221">Request handler</span></span>
    
<span data-ttu-id="cd336-222">Il gestore richieste **DocumentProviderEpsonFP90III** è il punto di ingresso per la richiesta di generare documenti dalla stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-222">The **DocumentProviderEpsonFP90III** request handler is the entry point for the request to generate documents from the fiscal printer.</span></span>

<span data-ttu-id="cd336-223">Il gestore viene ereditato dall'interfaccia **INamedRequestHandler**.</span><span class="sxs-lookup"><span data-stu-id="cd336-223">The handler is inherited from the **INamedRequestHandler** interface.</span></span> <span data-ttu-id="cd336-224">Il metodo **HandlerName** è responsabile della restituzione del nome del gestore.</span><span class="sxs-lookup"><span data-stu-id="cd336-224">The **HandlerName** method is responsible for returning the name of the handler.</span></span> <span data-ttu-id="cd336-225">Il nome del gestore deve corrispondere al nome del fornitore di documenti del connettore specificato in Retail Headquarters.</span><span class="sxs-lookup"><span data-stu-id="cd336-225">The handler name should match the connector document provider name that is specified in Retail Headquarters.</span></span>

<span data-ttu-id="cd336-226">Il connettore supporta le seguenti richieste:</span><span class="sxs-lookup"><span data-stu-id="cd336-226">The connector supports the following requests:</span></span>

- <span data-ttu-id="cd336-227">**GetFiscalDocumentDocumentProviderRequest** - Contiene informazioni su quale documento dovrà essere generato.</span><span class="sxs-lookup"><span data-stu-id="cd336-227">**GetFiscalDocumentDocumentProviderRequest** – This request contains information about what document should be generated.</span></span> <span data-ttu-id="cd336-228">Restituisce un documento specifico della stampante che deve essere registrato nella stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-228">It returns a printer-specific document that should be registered in the fiscal printer.</span></span>
- <span data-ttu-id="cd336-229">**GetSupportedRegistrableEventsDocumentProviderRequest** - Restituisce l'elenco degli eventi da sottoscrivere.</span><span class="sxs-lookup"><span data-stu-id="cd336-229">**GetSupportedRegistrableEventsDocumentProviderRequest** – This request returns the list of events to subscribe to.</span></span> <span data-ttu-id="cd336-230">Attualmente, i seguenti eventi sono supportati: vendita, stampa del report X e stampa del report Z.</span><span class="sxs-lookup"><span data-stu-id="cd336-230">Currently, the following events are supported: sales, printing X report, and printing Z report.</span></span>

### <a name="configuration"></a><span data-ttu-id="cd336-231">Configurazione</span><span class="sxs-lookup"><span data-stu-id="cd336-231">Configuration</span></span>

<span data-ttu-id="cd336-232">Il file di configurazione si trova nella cartella **Configuration** del progetto di estensione.</span><span class="sxs-lookup"><span data-stu-id="cd336-232">The configuration file is located in the **Configuration** folder of the extension project.</span></span> <span data-ttu-id="cd336-233">Lo scopo del file è di abilitare la configurazione delle impostazioni per il fornitore di documenti da Retail Headquarters.</span><span class="sxs-lookup"><span data-stu-id="cd336-233">The purpose of the file is to enable configuration of settings for the document provider from Retail Headquarters.</span></span> <span data-ttu-id="cd336-234">Il formato di file si allinea ai requisiti di configurazione dell'integrazione fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-234">The file format aligns fiscal integration configuration requirements.</span></span> <span data-ttu-id="cd336-235">Sono stati aggiunte i seguenti impostazioni:</span><span class="sxs-lookup"><span data-stu-id="cd336-235">The following settings have been added:</span></span>

- <span data-ttu-id="cd336-236">Mapping codici IVA</span><span class="sxs-lookup"><span data-stu-id="cd336-236">VAT codes mapping</span></span>
- <span data-ttu-id="cd336-237">Mapping aliquote IVA</span><span class="sxs-lookup"><span data-stu-id="cd336-237">VAT rates mapping</span></span>
- <span data-ttu-id="cd336-238">Mapping tipo di metodo di pagamento</span><span class="sxs-lookup"><span data-stu-id="cd336-238">Tender type mapping</span></span>
- <span data-ttu-id="cd336-239">Tipo di codice a barre per il numero di ricevuta</span><span class="sxs-lookup"><span data-stu-id="cd336-239">Barcode type for the receipt number</span></span>
- <span data-ttu-id="cd336-240">Tipo di pagamento deposito</span><span class="sxs-lookup"><span data-stu-id="cd336-240">Deposit payment type</span></span>

## <a name="hardware-station-extension-design"></a><span data-ttu-id="cd336-241">Progettazione dell'estensione stazione hardware</span><span class="sxs-lookup"><span data-stu-id="cd336-241">Hardware station extension design</span></span>

<span data-ttu-id="cd336-242">Lo scopo dell'estensione (connettore) è di comunicare con la stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-242">The purpose of the extension (connector) is to communicate with the fiscal printer.</span></span>

<span data-ttu-id="cd336-243">Estensione della stazione hardware: **HardwareStation.Extensions.EpsonFP90IIIFiscalDeviceSample**</span><span class="sxs-lookup"><span data-stu-id="cd336-243">Hardware station extension: **HardwareStation.Extensions.EpsonFP90IIIFiscalDeviceSample**</span></span>

<span data-ttu-id="cd336-244">L'estensione stazione hardware invia alla stampante fiscale (tramite il protocollo HTTP) i documenti generati dall'estensione di Commerce Runtime.</span><span class="sxs-lookup"><span data-stu-id="cd336-244">The Hardware station extension submits documents that the Commerce runtime extension generates to the fiscal printer (via HTTP protocol).</span></span> <span data-ttu-id="cd336-245">Gestisce inoltre le risposte ricevute dalla stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-245">It also handles the responses that are received from the fiscal printer.</span></span>

### <a name="request-handler"></a><span data-ttu-id="cd336-246">Gestore richieste</span><span class="sxs-lookup"><span data-stu-id="cd336-246">Request handler</span></span>

<span data-ttu-id="cd336-247">Il gestore richieste **EpsonFP90IIISample** è il punto di ingresso per la trasmissione della richiesta alla periferica fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-247">The **EpsonFP90IIISample** request handler is the entry point for handling request to the fiscal peripheral device.</span></span>

<span data-ttu-id="cd336-248">Il gestore viene ereditato dall'interfaccia **INamedRequestHandler**.</span><span class="sxs-lookup"><span data-stu-id="cd336-248">The handler is inherited from the **INamedRequestHandler** interface.</span></span> <span data-ttu-id="cd336-249">Il metodo **HandlerName** è responsabile della restituzione del nome del gestore.</span><span class="sxs-lookup"><span data-stu-id="cd336-249">The **HandlerName** method is responsible for returning the name of the handler.</span></span> <span data-ttu-id="cd336-250">Il nome del gestore deve corrispondere al nome del connettore fiscale specificato in Retail Headquarters.</span><span class="sxs-lookup"><span data-stu-id="cd336-250">The handler name should match the fiscal connector name that is specified in Retail Headquarters.</span></span>

<span data-ttu-id="cd336-251">Il connettore supporta le seguenti richieste:</span><span class="sxs-lookup"><span data-stu-id="cd336-251">The connector supports the following requests:</span></span>

- <span data-ttu-id="cd336-252">**SubmitDocumentFiscalDeviceRequest** - Invia documenti alle stampanti e restituisce la risposta dalla stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-252">**SubmitDocumentFiscalDeviceRequest** – This request sends documents to printers and returns the response from the fiscal printer.</span></span>
- <span data-ttu-id="cd336-253">**IsReadyFiscalDeviceRequest** - Viene utilizzata per un controllo di integrità del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="cd336-253">**IsReadyFiscalDeviceRequest** – This request is used for a health check of the device.</span></span>
- <span data-ttu-id="cd336-254">**InitializeFiscalDeviceRequest** - È utilizzata per l'inizializzazione della stampante.</span><span class="sxs-lookup"><span data-stu-id="cd336-254">**InitializeFiscalDeviceRequest** – This request is used for printer initialization.</span></span>

### <a name="configuration"></a><span data-ttu-id="cd336-255">Configurazione</span><span class="sxs-lookup"><span data-stu-id="cd336-255">Configuration</span></span>

<span data-ttu-id="cd336-256">Il file di configurazione si trova nella cartella **Configuration** del progetto di estensione.</span><span class="sxs-lookup"><span data-stu-id="cd336-256">The configuration file is found in the **Configuration** folder of the extension project.</span></span> <span data-ttu-id="cd336-257">Lo scopo del file è di abilitare la configurazione delle impostazioni per il fornitore di connettore da Retail Headquarters.</span><span class="sxs-lookup"><span data-stu-id="cd336-257">The purpose of the file is to enable configuration of settings for the connector provider from Retail Headquarters.</span></span> <span data-ttu-id="cd336-258">Il formato di file si allinea ai requisiti di configurazione dell'integrazione fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-258">The file format aligns fiscal integration configuration requirements.</span></span> <span data-ttu-id="cd336-259">Sono stati aggiunte i seguenti impostazioni:</span><span class="sxs-lookup"><span data-stu-id="cd336-259">The following settings have been added:</span></span>

- <span data-ttu-id="cd336-260">**Indirizzo endpoint** - L'URL della stampante.</span><span class="sxs-lookup"><span data-stu-id="cd336-260">**Endpoint address** – The URL of the printer.</span></span>
- <span data-ttu-id="cd336-261">**Sincronizzazione data e ora** - Questa impostazione indica se è necessaria la sincronizzazione di data e ora della stampante con la stazione hardware collegata.</span><span class="sxs-lookup"><span data-stu-id="cd336-261">**Date and time synchronization** – This setting indicates whether you must sync the date and time of the printer with the connected Hardware station.</span></span> <span data-ttu-id="cd336-262">La data e l'ora della stampante verranno sincronizzate con quelle della stazione hardware.</span><span class="sxs-lookup"><span data-stu-id="cd336-262">The date and time of the printer will be synced with the Hardware station time.</span></span>

## <a name="limitations-of-the-sample"></a><span data-ttu-id="cd336-263">Limitazioni dell'esempio</span><span class="sxs-lookup"><span data-stu-id="cd336-263">Limitations of the sample</span></span>

- <span data-ttu-id="cd336-264">La stampante fiscale supporta solo gli scenari in cui l'IVA è inclusa nel prezzo.</span><span class="sxs-lookup"><span data-stu-id="cd336-264">The fiscal printer supports only scenarios where sales tax is included in the price.</span></span> <span data-ttu-id="cd336-265">Di conseguenza, l'opzione **Prezzi IVA inclusa** deve essere impostata su **Sì** per i punti vendita al dettaglio e i clienti.</span><span class="sxs-lookup"><span data-stu-id="cd336-265">Therefore, the **Price include sales tax** option must be set to **Yes** for both retail stores and customers.</span></span>
- <span data-ttu-id="cd336-266">I report giornalieri (X e Z fiscali) vengono stampati utilizzando il formato incorporato nel firmware della stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-266">Daily reports (fiscal X and fiscal Z) are printed by using the format that is embedded in the fiscal printer firmware.</span></span>
- <span data-ttu-id="cd336-267">Le transazioni miste non sono supportate dalla stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="cd336-267">Mixed transactions aren't supported by the fiscal printer.</span></span> <span data-ttu-id="cd336-268">L'opzione **Impedisci di combinare vendite e resi in una ricevuta** deve essere impostata su **Sì** nei profili funzionalità POS.</span><span class="sxs-lookup"><span data-stu-id="cd336-268">The **Prohibit mixing sales and returns in one receipt** option should be set to **Yes** in POS functionality profiles.</span></span>
- <span data-ttu-id="cd336-269">L'esempio supporta l'integrazione solo con una stampante fiscale che funziona in modalità RT (Registrazione Telematico).</span><span class="sxs-lookup"><span data-stu-id="cd336-269">The sample supports integration only with a fiscal printer that is working in the RT (Registratore Telematico) mode.</span></span> 
