---
title: Controllo di coerenza per le transazioni di vendita al dettaglio
description: In questo argomento viene descritta la funzionalità di controllo di coerenza per le transazioni di vendita al dettaglio in Dynamics 365 Retail.
author: josaw1
manager: AnnBe
ms.date: 10/14/2019
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2019-01-15
ms.dyn365.ops.version: 10
ms.openlocfilehash: b956565ac15b3d7b638cedaadc20923ee87b9c61
ms.sourcegitcommit: 0262a19e32b2c0c84c731d9f4fbe8ba91822afa3
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 10/15/2019
ms.locfileid: "2622599"
---
# <a name="retail-transaction-consistency-checker"></a><span data-ttu-id="fd0f2-103">Controllo di coerenza per le transazioni di vendita al dettaglio</span><span class="sxs-lookup"><span data-stu-id="fd0f2-103">Retail transaction consistency checker</span></span>


[!include [banner](includes/banner.md)]
[!include [preview banner](includes/preview-banner.md)]

<span data-ttu-id="fd0f2-104">In questo argomento viene descritta la funzionalità di controllo di coerenza per le transazioni di vendita al dettaglio.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-104">This topic describes the retail transaction consistency checker functionality.</span></span> <span data-ttu-id="fd0f2-105">Il controllo di coerenza identifica e isole le transazioni incoerenti prima che vengano prelevate dal processo di registrazione rendiconti.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-105">The consistency checker identifies and isolates inconsistent transactions before they are picked up by the statement posting process.</span></span>

<span data-ttu-id="fd0f2-106">Quando un rendiconto viene registrato in Retail, la registrazione può non riuscire a causa di dati incoerenti nelle tabelle di transazioni di vendita al dettaglio.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-106">When a statement is posted in Retail, posting can fail due to inconsistent data in the retail transaction tables.</span></span> <span data-ttu-id="fd0f2-107">Il problema sui dati può essere causato da problemi non previsti nell'applicazione POS o da transazioni importate in modo non corretto da sistemi POS di terze parti.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-107">The data issue may be caused by unforeseen issues in the point of sale (POS) application, or if transactions were incorrectly imported from third-party POS systems.</span></span> <span data-ttu-id="fd0f2-108">Esempi di come le incoerenze possono essere visualizzate includono i seguenti:</span><span class="sxs-lookup"><span data-stu-id="fd0f2-108">Examples of how these inconsistencies may appear include:</span></span> 

- <span data-ttu-id="fd0f2-109">Il totale delle transazioni nella tabella di intestazione non corrisponde al totale delle transazioni nelle righe.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-109">The transaction total on the header table does not match the transaction total on the lines.</span></span>
- <span data-ttu-id="fd0f2-110">Il conteggio delle righe nella tabella di intestazione non corrisponde al numero di righe nella tabella di transazioni.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-110">The line count on the header table does not match with the number of lines in the transaction table.</span></span>
- <span data-ttu-id="fd0f2-111">Le imposte nella tabella di intestazione non corrispondono all'importo delle imposte nelle righe.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-111">Taxes on the header table do not match the tax amount on the lines.</span></span> 

<span data-ttu-id="fd0f2-112">Quando il processo di registrazione rendiconti preleva transazioni incoerenti, vengono creati giornali di registrazione pagamenti e fatture di vendita incoerenti e di conseguenza tutto il processo di registrazione rendiconti ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-112">When inconsistent transactions are picked up by the statement posting process, inconsistent sales invoices and payment journals are created, and the entire statement posting process fails as a result.</span></span> <span data-ttu-id="fd0f2-113">Il recupero dei rendiconti da uno stato di questo tipo prevede rettifiche complessi di dati in più tabelle di transazioni.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-113">Recovering the statements from such a state involves complex data fixes across multiple transaction tables.</span></span> <span data-ttu-id="fd0f2-114">Il controllo di coerenza per le transazioni di vendita al dettaglio consente di evitare questi problemi.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-114">The retail transaction consistency checker prevents such issues.</span></span>

<span data-ttu-id="fd0f2-115">Nel grafico seguente è illustrato il processo di registrazione con il controllo di coerenza per le transazioni.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-115">The following chart illustrates the posting process with the transaction consistency checker.</span></span>

<span data-ttu-id="fd0f2-116">![Processo di registrazione dei rendiconto con il controllo di coerenza per le transazioni di vendita al dettaglio](./media/validchecker.png "Processo di registrazione dei rendiconto con il controllo di coerenza per le transazioni di vendita al dettaglio")</span><span class="sxs-lookup"><span data-stu-id="fd0f2-116">![Statement posting process with retail transaction consistency checker](./media/validchecker.png "Statement posting process with retail transaction consistency checker")</span></span>

<span data-ttu-id="fd0f2-117">Il processo batch **Convalida transazioni punto vendita** controlla la coerenza delle tabelle di transazioni di vendita al dettaglio per gli scenari seguenti.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-117">The **Validate store transactions** batch process checks the consistency of the retail transaction tables for the following scenarios.</span></span>

- <span data-ttu-id="fd0f2-118">**Conto cliente** - Verifica che il conto cliente presente nelle tabelle di transazioni di vendita al dettaglio sia presente nei dati master cliente della sede centrale.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-118">**Customer account** – Validates that the customer account in the retail transaction tables exists in the HQ customer master.</span></span>
- <span data-ttu-id="fd0f2-119">**Conteggio righe** - Verifica che il numero di righe, come acquisito nella tabella di intestazione delle transazioni, corrisponda al numero di righe nelle tabelle di transazioni vendite.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-119">**Line count** – Validates that the number of lines, as captured on the transaction header table, matches the number of lines in the sales transaction tables.</span></span>
- <span data-ttu-id="fd0f2-120">**Prezzo IVA inclusa** - Verifica che il parametro **Prezzo IVA inclusa** sia coerente nelle righe di transazione.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-120">**Price includes tax** – Validates that the **Price includes tax** parameter is consistent across transaction lines.</span></span>
- <span data-ttu-id="fd0f2-121">**Importo pagamento** - Verifica che i record di pagamento corrispondano all'importo del pagamento sull'intestazione.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-121">**Payment amount** - Validates that the payment records match the payment amount on header.</span></span>
- <span data-ttu-id="fd0f2-122">**Importo lordo** - Verifica che l'importo lordo nell'intestazione sia la somma degli importi netti presenti nelle righe e dell'importo IVA.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-122">**Gross amount** – Validates that the gross amount on the header is the sum of the net amounts on the lines plus the tax amount.</span></span>
- <span data-ttu-id="fd0f2-123">**Importo netto** - Verifica che l'importo netto nell'intestazione sia la somma degli importi netti presenti nelle righe.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-123">**Net amount** – Validates that the net amount on the header is the sum of the net amounts on the lines.</span></span>
- <span data-ttu-id="fd0f2-124">**Insufficienza/Eccedenza pagamento** - Verifica che la differenza tra l'importo lordo presente nell'intestazione e l'importo del pagamento non superi la configurazione massima di insufficienza/eccedenza pagamento.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-124">**Under / Over payment** – Validates that the difference between the gross amount on the header and the payment amount doesn't exceed the maximum underpayment/overpayment configuration.</span></span>
- <span data-ttu-id="fd0f2-125">**Importo sconto** - Verifica che l'importo di sconto presente nelle tabelle di sconto e quello presente nelle tabelle di righe transazioni di vendita al dettaglio siano coerenti e che l'importo dello sconto nell'intestazione sia la somma degli importi di sconto nelle righe.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-125">**Discount amount** – Validates that the discount amount on the discount tables and the discount amount on the retail transaction line tables are consistent, and that the discount amount on the header is the sum of the discount amounts on the lines.</span></span>
- <span data-ttu-id="fd0f2-126">**Sconto riga** - Verifica che lo sconto presente nella riga di transazione sia la somma di tutte le righe nella tabella sconti corrispondente alla riga di transazione.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-126">**Line discount** – Validates that the line discount on the transaction line is the sum of all the lines in the discount table that corresponds to the transaction line.</span></span>
- <span data-ttu-id="fd0f2-127">**Articolo gift card** - In Retail la restituzione di articoli con gift card non è supportata.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-127">**Gift card item** – Retail doesn't support the return of gift card items.</span></span> <span data-ttu-id="fd0f2-128">Il saldo di una gift card, tuttavia, può essere liquidato. Qualsiasi articolo con gift card elaborato come riga di reso anziché come riga di liquidazione provoca un errore nel processo di registrazione rendiconti.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-128">However, the balance on a gift card can be cashed out. Any gift card item that is processed as a return line instead of a cash-out line fails the statement posting process.</span></span> <span data-ttu-id="fd0f2-129">Il processo di convalida per gli articoli con gift card garantisce che solo le voci di reso relative alla gift card presenti nella tabella di transazioni di vendita al dettaglio siano righe di liquidazione gift card.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-129">The validation process for gift card items helps guarantee that the only return gift card line items on the retail transaction tables are gift card cash-out lines.</span></span>
- <span data-ttu-id="fd0f2-130">**Prezzo negativo** - Verifica che non sia presente alcuna riga di transazione prezzo negativo.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-130">**Negative price** – Validates that there are no negative price transaction lines.</span></span>
- <span data-ttu-id="fd0f2-131">**Articolo e variante** - Verifica che gli articoli e le varianti nelle righe di transazione siano presenti nel file master relativo.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-131">**Item & Variant** – Validates that items and variants on the transaction lines exist in the item and variant master file.</span></span>
- <span data-ttu-id="fd0f2-132">**Importo imposta** - Verifica che i record di imposta corrispondano agli importi nelle righe.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-132">**Tax amount** - Validates that tax records match the tax amounts on the lines.</span></span>
- <span data-ttu-id="fd0f2-133">**Numero di serie** - Verifica che il numero di serie sia presente nelle righe di transazione per gli articoli controllati dal numero di serie.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-133">**Serial number** - Validates that the serial number is present in the transaction lines for items that are controlled by serial number.</span></span>
- <span data-ttu-id="fd0f2-134">**Segno** - Verifica che il segno della quantità e dell'importo netto sia lo stesso in tutte le righe di transazione.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-134">**Sign** - Validates that the sign on the quantity and the net amount are the same in all the transaction lines.</span></span>
- <span data-ttu-id="fd0f2-135">**Data attività** - Verifica che i periodi finanziari per tutte le date di attività delle transazioni di vendita al dettaglio siano aperti.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-135">**Business date** - Validates that the financial periods for all the business dates for the retail transactions are open.</span></span>

## <a name="set-up-the-consistency-checker"></a><span data-ttu-id="fd0f2-136">Impostare il controllo di coerenza</span><span class="sxs-lookup"><span data-stu-id="fd0f2-136">Set up the consistency checker</span></span>

<span data-ttu-id="fd0f2-137">Configurare il processo batch "Convalida transazioni punto vendita" in **Vendita al dettaglio \> Vendita al dettaglio IT \> Registrazione POS** per esecuzioni periodiche.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-137">Configure the "Validate store transactions" batch process, at **Retail \> Retail IT \> POS posting**, for periodic runs.</span></span> <span data-ttu-id="fd0f2-138">Il processo batch può essere programmato in base alla gerarchia organizzativa, in modo analogo a come vengono impostati i processi "Calcola rendiconti in batch" e "Registra rendiconti in batch".</span><span class="sxs-lookup"><span data-stu-id="fd0f2-138">The batch job can be scheduled based on store organization hierarchy, similar to how the "Calculate statement in batch" and "Post statement in batch" processes are set up.</span></span> <span data-ttu-id="fd0f2-139">Si consiglia di configurare questo processo batch per più esecuzioni giornaliere e di programmarlo in modo che venga eseguito al termine di ogni esecuzione del processo P.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-139">We recommend that you configure this batch process to run multiple times in a day and schedule it so that it runs at the end of every P-job execution.</span></span>

## <a name="results-of-validation-process"></a><span data-ttu-id="fd0f2-140">Risultati del processo di convalida</span><span class="sxs-lookup"><span data-stu-id="fd0f2-140">Results of validation process</span></span>

<span data-ttu-id="fd0f2-141">I risultati della verifica di convalida eseguita dal processo batch sono contrassegnati sulla transazione di vendita al dettaglio appropriata.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-141">The results of the validation check by the batch process are tagged on the appropriate retail transaction.</span></span> <span data-ttu-id="fd0f2-142">Il campo **Stato convalida** nel record di transazione di vendita al dettaglio è impostato su **Operazione completata** o **Errore** e la data dell'ultima convalida viene visualizzata nel campo **Ora ultima convalida**.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-142">The **Validation status** field on the retail transaction record is either set to **Successful** or **Error**, and the date of the last validation run appears on the **Last validation time** field.</span></span>

<span data-ttu-id="fd0f2-143">Per visualizzare più testo descrittivo dell'errore relativo a una mancata convalida, selezionare il record di transazione di punto vendita al dettaglio e fare clic sul pulsante **Errori di convalida**.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-143">To view more descriptive error text relating to a validation failure, select the relevant retail store transaction record and click the **Validation errors** button.</span></span>

<span data-ttu-id="fd0f2-144">Le transazioni che non superano il controllo di convalida e quelle non ancora convalidate non verranno inserite nei rendiconti.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-144">Transactions that fail the validation check and transactions that have not yet been validated will not be pulled into statements.</span></span> <span data-ttu-id="fd0f2-145">Durante il processo di calcolo dei rendiconti, agli utenti verrà comunicato se sono presenti transazioni che sarebbe stato possibile includere nel rendiconto, ma non lo sono state.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-145">During the "Calculate statement" process, users will be notified if there are transactions that could have been included in the statement but weren't.</span></span>

<span data-ttu-id="fd0f2-146">Se viene rilevato un errore di convalida, per correggerlo è necessario contattare il servizio di supporto tecnico Microsoft.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-146">If a validation error is found, the only way to fix the error is to contact Microsoft Support.</span></span> <span data-ttu-id="fd0f2-147">In una versione futura, verrà aggiunta la possibilità per gli utenti di correggere i record con errore nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-147">In a future release, capability will be added so that users can fix the records that failed through the user interface.</span></span> <span data-ttu-id="fd0f2-148">Verranno rese disponibili anche funzionalità di registrazione e controllo per tenere traccia dello storico delle modifiche.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-148">Logging and auditing capabilities will also be made available to trace the history of the modifications.</span></span>

> [!NOTE]
> <span data-ttu-id="fd0f2-149">Regole di convalida aggiuntive supportare più scenari verranno aggiunte in una versione futura.</span><span class="sxs-lookup"><span data-stu-id="fd0f2-149">Additional validation rules to support more scenarios will be added in a future release.</span></span>
