---
title: Panoramica dell'integrazione fiscale per i canali di commercio
description: In questo argomento viene fornita una panoramica delle funzionalità di integrazione fiscale disponibili in Dynamics 365 Commerce.
author: josaw
manager: annbe
ms.date: 02/01/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailFunctionalityProfile, RetailFormLayout, RetailParameters
audience: Application User
ms.reviewer: josaw
ms.search.region: Global
ms.search.industry: Retail
ms.author: epopov
ms.search.validFrom: 2019-1-16
ms.dyn365.ops.version: 10
ms.openlocfilehash: d766515d82e021f41e0cc0a9a877f25551817ad5
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 02/15/2021
ms.locfileid: "5250832"
---
# <a name="overview-of-fiscal-integration-for-commerce-channels"></a><span data-ttu-id="f9468-103">Panoramica dell'integrazione fiscale per i canali di commercio</span><span class="sxs-lookup"><span data-stu-id="f9468-103">Overview of fiscal integration for Commerce channels</span></span>

[!include [banner](../includes/banner.md)]

## <a name="introduction"></a><span data-ttu-id="f9468-104">Introduzione</span><span class="sxs-lookup"><span data-stu-id="f9468-104">Introduction</span></span>

<span data-ttu-id="f9468-105">In questo argomento viene fornita una panoramica delle funzionalità di integrazione fiscale disponibili in Dynamics 365 Commerce.</span><span class="sxs-lookup"><span data-stu-id="f9468-105">This topic is an overview of the fiscal integration capabilities that are available in Dynamics 365 Commerce.</span></span> <span data-ttu-id="f9468-106">L'integrazione fiscale include l'integrazione con vari servizi e dispositivi fiscali che consentono la registrazione fiscale delle vendite in conformità con le leggi fiscali locali intese a impedire la frode fiscale nel settore della vendita al dettaglio.</span><span class="sxs-lookup"><span data-stu-id="f9468-106">Fiscal integration includes integration with various fiscal devices and services that enable fiscal registration of sales in accordance with local fiscal laws that are aimed at preventing tax fraud in the retail industry.</span></span> <span data-ttu-id="f9468-107">Di seguito sono riportati alcuni scenari comuni che possono essere coperti utilizzando l'integrazione fiscale:</span><span class="sxs-lookup"><span data-stu-id="f9468-107">Here are some typical scenarios that can be covered by using fiscal integration:</span></span>

- <span data-ttu-id="f9468-108">Registrare una vendita in un dispositivo fiscale collegato al POS, ad esempio una stampante fiscale, e stampare una ricevuta fiscale per il cliente.</span><span class="sxs-lookup"><span data-stu-id="f9468-108">Register a sale on a fiscal device that is connected to point of sale (POS), such as a fiscal printer, and print a fiscal receipt for the customer.</span></span>
- <span data-ttu-id="f9468-109">Inviare in modo sicuro informazioni relative a vendite e resi completati in Retail POS a un servizio Web esterno gestito dall'ufficio tributario competente.</span><span class="sxs-lookup"><span data-stu-id="f9468-109">Securely submit information that is related to sales and returns that are completed in Retail POS to an external web-service that is operated by the tax authority.</span></span>
- <span data-ttu-id="f9468-110">Assicurare l'inalterabilità dei dati delle transazioni di vendita mediante firme digitali.</span><span class="sxs-lookup"><span data-stu-id="f9468-110">Help guarantee inalterability of sales transaction data through digital signatures.</span></span>

<span data-ttu-id="f9468-111">La funzionalità di integrazione fiscale è un framework che fornisce una soluzione comune per un ulteriore sviluppo e personalizzazione dell'integrazione tra Retail POS e i servizi e i dispositivi fiscali.</span><span class="sxs-lookup"><span data-stu-id="f9468-111">The fiscal integration functionality is a framework that provides a common solution for further development and customization of the integration between Retail POS and fiscal devices and services.</span></span> <span data-ttu-id="f9468-112">La funzionalità include inoltre campioni di integrazione fiscale che supportano scenari di base per specifici paesi o aree geografiche e utilizzabili con specifici servizi o dispositivi fiscali.</span><span class="sxs-lookup"><span data-stu-id="f9468-112">The functionality also includes fiscal integration samples that support basic scenarios for specific countries or regions, and that work with specific fiscal devices or services.</span></span> <span data-ttu-id="f9468-113">Un esempio di integrazione fiscale è costituito da più estensioni di componenti di Commerce ed è incluso nel kit SDK.</span><span class="sxs-lookup"><span data-stu-id="f9468-113">A fiscal integration sample consists of several extensions of Commerce components and is included in the software development kit (SDK).</span></span> <span data-ttu-id="f9468-114">Per ulteriori informazioni su esempi di integrazione fiscale, vedere [Esempi di integrazione fiscale in Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span><span class="sxs-lookup"><span data-stu-id="f9468-114">For more information about the fiscal integration samples, see [Fiscal integration samples in the Retail SDK](#fiscal-integration-samples-in-the-retail-sdk).</span></span> <span data-ttu-id="f9468-115">Per informazioni su come installare e utilizzare Retail SDK, vedere [Architettura di Retail SDK](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span><span class="sxs-lookup"><span data-stu-id="f9468-115">For information about how to install and use the Retail SDK, see [Retail software development kit (SDK) architecture](../dev-itpro/retail-sdk/retail-sdk-overview.md).</span></span>

<span data-ttu-id="f9468-116">Per supportare altri scenari non supportati da un esempio di integrazione fiscale, integrare Retail Retail POS con altri servizi o dispositivi fiscali o soddisfare i requisiti di altri paesi o aree geografiche, è necessario estendere un esempio di integrazione fiscale esistente o creare un nuovo esempio utilizzando un esempio esistente.</span><span class="sxs-lookup"><span data-stu-id="f9468-116">To support other scenarios that aren't supported by a fiscal integration sample, to integrate Retail POS with other fiscal devices or services, or to cover requirements of other countries or regions, you must either extend an existing fiscal integration sample or create a new sample by using an existing sample as an example.</span></span>

## <a name="fiscal-registration-process-and-fiscal-integration-samples-for-fiscal-devices"></a><span data-ttu-id="f9468-117">Processo di registrazione fiscale ed esempi di integrazione fiscale per dispositivi fiscali</span><span class="sxs-lookup"><span data-stu-id="f9468-117">Fiscal registration process and fiscal integration samples for fiscal devices</span></span>

<span data-ttu-id="f9468-118">Un processo di registrazione fiscale in Retail POS può essere costituito da una o più fasi.</span><span class="sxs-lookup"><span data-stu-id="f9468-118">A fiscal registration process in Retail POS can consist of one or more steps.</span></span> <span data-ttu-id="f9468-119">Ogni fase comporta la registrazione fiscale di specifici eventi o transazioni in un servizio o dispositivo fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-119">Each step involves fiscal registration of specific transactions or events in one fiscal device or service.</span></span> <span data-ttu-id="f9468-120">I componenti seguenti contribuiscono alla registrazione fiscale in un dispositivo fiscale collegato a una stazione hardware:</span><span class="sxs-lookup"><span data-stu-id="f9468-120">The following solution components participate in the fiscal registration in a fiscal device that is connected to a Hardware station:</span></span>

- <span data-ttu-id="f9468-121">**Estendibilità di Commerce Runtime (CRT)** - Questo componente serializza i dati di evento/transazione nel formato utilizzato anche per l'interazione con il dispositivo fiscale, analizza le risposte del dispositivo fiscale e le archivia nel database del canale.</span><span class="sxs-lookup"><span data-stu-id="f9468-121">**Commerce runtime (CRT) extension** – This component serializes transaction/event data in the format that is also used for interaction with the fiscal device, parses responses from the fiscal device, and stores the responses in the channel database.</span></span> <span data-ttu-id="f9468-122">L'estensione inoltre definisce le transazioni e gli eventi specifici che è necessario registrare.</span><span class="sxs-lookup"><span data-stu-id="f9468-122">The extension also defines the specific transactions and events that must be registered.</span></span> <span data-ttu-id="f9468-123">Questo componente è spesso denominato *fornitore di documenti fiscali*.</span><span class="sxs-lookup"><span data-stu-id="f9468-123">This component is often referred to as a *fiscal document provider*.</span></span>
- <span data-ttu-id="f9468-124">**Estensione stazione hardware** - Questo componente inizializza la comunicazione con il dispositivo fiscale, invia le richieste e i comandi al dispositivo fiscale in base ai dati di evento/transazione estratti dal documento fiscale e riceve le risposte dal dispositivo fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-124">**Hardware station extension** – This component initializes the communication with the fiscal device, sends requests and direct commands to the fiscal device based on the transaction/event data that is extracted from the fiscal document, and receives responses from the fiscal device.</span></span> <span data-ttu-id="f9468-125">Questo componente è spesso denominato *connettore fiscale*.</span><span class="sxs-lookup"><span data-stu-id="f9468-125">This component is often referred to as a *fiscal connector*.</span></span>

<span data-ttu-id="f9468-126">Un esempio di integrazione fiscale per un dispositivo fiscale contiene le estensioni CRT e stazione hardware per rispettivamente un fornitore di documenti fiscali e un connettore fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-126">A fiscal integration sample for a fiscal device contains the CRT and Hardware station extensions for a fiscal document provider and a fiscal connector, respectively.</span></span> <span data-ttu-id="f9468-127">Include inoltre le configurazioni di componente seguenti:</span><span class="sxs-lookup"><span data-stu-id="f9468-127">It also contains the following component configurations:</span></span>

- <span data-ttu-id="f9468-128">**Configurazione fornitore di documenti fiscali** - Questa configurazione definisce un metodo di output e un formato per i documenti fiscali.</span><span class="sxs-lookup"><span data-stu-id="f9468-128">**Fiscal document provider configuration** – This configuration defines an output method and a format for fiscal documents.</span></span> <span data-ttu-id="f9468-129">Include inoltre un mapping dei dati per le imposte e i metodi di pagamento, per rendere i dati di Retail POS compatibili con i valori predefiniti nel firmware del dispositivo fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-129">It also contains a data mapping for taxes and payment methods, to make data from Retail POS compatible with the values that are predefined in the fiscal device firmware.</span></span>
- <span data-ttu-id="f9468-130">**Configurazione di connettore fiscale** - Questa configurazione definisce la comunicazione fisica con il dispositivo fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-130">**Fiscal connector configuration** – This configuration defines the physical communication with the specific fiscal device.</span></span>

<span data-ttu-id="f9468-131">Un processo di registrazione fiscale per un registro POS specifico viene definito tramite un'impostazione corrispondente nel profilo funzionalità POS.</span><span class="sxs-lookup"><span data-stu-id="f9468-131">A fiscal registration process for a specific POS register is defined by a corresponding setting in the POS functionality profile.</span></span> <span data-ttu-id="f9468-132">Per ulteriori informazioni su come configurare un processo di registrazione fiscale, caricare le configurazioni di fornitore di documenti fiscali e di connettore fiscale e modificarne i parametri, vedere [Configurazione di un processo di registrazione fiscale](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span><span class="sxs-lookup"><span data-stu-id="f9468-132">For more details about how to configure a fiscal registration process, upload fiscal document provider and fiscal connector configurations, and change their parameters, see [Set up a fiscal registration process](setting-up-fiscal-integration-for-retail-channel.md#set-up-a-fiscal-registration-process).</span></span>

<span data-ttu-id="f9468-133">Nell'esempio seguente viene illustrato un flusso di esecuzione di registrazione fiscale tipico per un dispositivo fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-133">The following example shows a typical fiscal registration execution flow for a fiscal device.</span></span> <span data-ttu-id="f9468-134">Il flusso inizia con un evento nel POS (ad esempio, il completamento di una transazione di vendita) e implementa la seguente sequenza di fasi:</span><span class="sxs-lookup"><span data-stu-id="f9468-134">The flow starts with an event in the POS (for example, finalization of a sales transaction) and implements the following sequence of steps:</span></span>

1. <span data-ttu-id="f9468-135">Il POS richiede un documento fiscale da CRT.</span><span class="sxs-lookup"><span data-stu-id="f9468-135">The POS requests a fiscal document from CRT.</span></span>
2. <span data-ttu-id="f9468-136">CRT determina se l'evento corrente richiede la registrazione fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-136">CRT determines whether the current event requires fiscal registration.</span></span>
3. <span data-ttu-id="f9468-137">In base alle impostazioni del processo di registrazione fiscale, CRT identifica un connettore fiscale e un fornitore di documenti fiscali corrispondente da utilizzare per la registrazione fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-137">Based on the fiscal registration process settings, CRT identifies a fiscal connector and corresponding fiscal document provider to use for the fiscal registration.</span></span>
4. <span data-ttu-id="f9468-138">CRT esegue il fornitore di documenti fiscali che genera un documento fiscale (ad esempio, un documento XML) che rappresenta l'evento o la transazione.</span><span class="sxs-lookup"><span data-stu-id="f9468-138">CRT runs the fiscal document provider that generates a fiscal document (for example, an XML document) that represents the transaction or event.</span></span>
5. <span data-ttu-id="f9468-139">Il POS invia il documento fiscale preparato da CRT a una stazione hardware.</span><span class="sxs-lookup"><span data-stu-id="f9468-139">The POS sends the fiscal document that CRT prepares to a Hardware station.</span></span>
6. <span data-ttu-id="f9468-140">La stazione hardware esegue il connettore fiscale che elabora il documento fiscale e lo comunica al servizio o al dispositivo fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-140">The Hardware station runs the fiscal connector that processes the fiscal document and communicates it to the fiscal device or service.</span></span>
7. <span data-ttu-id="f9468-141">Il POS analizza la risposta del servizio o del dispositivo fiscale per determinare se la registrazione fiscale è stata eseguita correttamente.</span><span class="sxs-lookup"><span data-stu-id="f9468-141">The POS analyzes the response from the fiscal device or service to determine whether the fiscal registration was successful.</span></span>
8. <span data-ttu-id="f9468-142">CRT salva la risposta nel database del canale.</span><span class="sxs-lookup"><span data-stu-id="f9468-142">CRT saves the response to the channel database.</span></span>

<span data-ttu-id="f9468-143">![Schema soluzione](media/emea-fiscal-integration-solution.png "Schema soluzione")</span><span class="sxs-lookup"><span data-stu-id="f9468-143">![Solution schema](media/emea-fiscal-integration-solution.png "Solution schema")</span></span>

## <a name="error-handling"></a><span data-ttu-id="f9468-144">Gestione errori</span><span class="sxs-lookup"><span data-stu-id="f9468-144">Error handling</span></span>

<span data-ttu-id="f9468-145">Il framework di integrazione fiscale fornisce le seguenti opzioni per gestire gli errori durante la registrazione fiscale:</span><span class="sxs-lookup"><span data-stu-id="f9468-145">The fiscal integration framework provides the following options to handle failures during fiscal registration:</span></span>

- <span data-ttu-id="f9468-146">**Riprova** - Gli operatori possono utilizzare questa opzione quando l'errore può essere risolto rapidamente e la registrazione fiscale può essere eseguita di nuovo.</span><span class="sxs-lookup"><span data-stu-id="f9468-146">**Retry** – Operators can use this option when the failure can be resolved quickly, and the fiscal registration can be rerun.</span></span> <span data-ttu-id="f9468-147">Ad esempio, questa opzione può essere utilizzata quando il dispositivo fiscale non è collegato, la carta è esaurita o inceppata nella stampante fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-147">For example, this option can be used when the fiscal device isn't connected, the fiscal printer is out of paper, or there is a paper jam in the fiscal printer.</span></span>
- <span data-ttu-id="f9468-148">**Annulla** - Questa opzione consente agli operatori di posticipare la registrazione fiscale della transazione o dell'evento corrente se questo ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="f9468-148">**Cancel** – This option lets operators postpone the fiscal registration of the current transaction or event if it fails.</span></span> <span data-ttu-id="f9468-149">Dopo che la registrazione è stata posticipata, l'operatore può continuare a utilizzare il POS e completare le operazioni per le quali la registrazione fiscale non è necessaria.</span><span class="sxs-lookup"><span data-stu-id="f9468-149">After the registration is postponed, the operator can continue to work on the POS and can complete any operation that the fiscal registration isn't required for.</span></span> <span data-ttu-id="f9468-150">Quando si verifica un evento che richiede la registrazione fiscale nel POS (ad esempio, viene aperta una nuova transazione), la finestra di dialogo di gestione degli errori viene automaticamente visualizzata per informare l'operatore che la transazione precedente non è stata registrata correttamente e per fornire le opzioni di gestione degli errori.</span><span class="sxs-lookup"><span data-stu-id="f9468-150">When any event that requires the fiscal registration occurs in the POS (for example, a new transaction is opened), the error handling dialog box automatically appears to notify the operator that the previous transaction wasn't correctly registered and to provide the error handling options.</span></span>
- <span data-ttu-id="f9468-151">**Ignora** - Gli operatori possono utilizzare questa opzione quando la registrazione fiscale può essere omessa in determinate condizioni e le operazioni normali possono essere eseguite nel POS.</span><span class="sxs-lookup"><span data-stu-id="f9468-151">**Skip** – Operators can use this option when the fiscal registration can be omitted under specific conditions and regular operations can be continued on the POS.</span></span> <span data-ttu-id="f9468-152">Ad esempio, questa opzione può essere utilizzata se una transazione di vendita per la quale la registrazione fiscale non è riuscita può essere registrata in un giornale speciale.</span><span class="sxs-lookup"><span data-stu-id="f9468-152">For example, this option can be used when a sales transaction that the fiscal registration failed for can be registered in a special paper journal.</span></span>
- <span data-ttu-id="f9468-153">**Contrassegna come registrato** - Gli operatori possono utilizzare questa opzione quando la transazione è stata effettivamente registrata nel dispositivo fiscale (ad esempio, è stata stampata una ricevuta fiscale), ma si è verificato un errore durante il salvataggio della risposta fiscale nel database del canale.</span><span class="sxs-lookup"><span data-stu-id="f9468-153">**Mark as registered** – Operators can use this option when the transaction was actually registered in the fiscal device (for example, a fiscal receipt was printed), but a failure occurred when the fiscal response was being saved to the channel database.</span></span>

> [!NOTE]
> <span data-ttu-id="f9468-154">Le opzioni **Ignora** e **Contrassegna come registrato** devono essere attivate nel processo di registrazione fiscale prima di essere utilizzate.</span><span class="sxs-lookup"><span data-stu-id="f9468-154">The **Skip** and **Mark as registered** options must be activated in the fiscal registration process before they are used.</span></span> <span data-ttu-id="f9468-155">Inoltre, le autorizzazioni corrispondenti devono essere concesse agli operatori.</span><span class="sxs-lookup"><span data-stu-id="f9468-155">In addition, corresponding permissions must be granted to operators.</span></span>

<span data-ttu-id="f9468-156">Le opzioni **Ignora** e **Contrassegna come registrato** attivano codici informativi per acquisire alcune informazioni specifiche sull'errore, ad esempio la causa dell'errore o il motivo per aver ignorato la registrazione fiscale o contrassegnato la transazione come registrata.</span><span class="sxs-lookup"><span data-stu-id="f9468-156">The **Skip** and **Mark as registered** options enable info codes to capture some specific information about the failure, such as the reason for the failure or a justification for skipping the fiscal registration or marking the transaction as registered.</span></span> <span data-ttu-id="f9468-157">Per ulteriori informazioni su come impostare i parametri di gestione degli errori, vedere [Configurare le impostazioni di gestione degli errori](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="f9468-157">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="optional-fiscal-registration"></a><span data-ttu-id="f9468-158">Registrazione fiscale facoltativa</span><span class="sxs-lookup"><span data-stu-id="f9468-158">Optional fiscal registration</span></span>

<span data-ttu-id="f9468-159">La registrazione fiscale può essere obbligatoria per alcune operazioni ma facoltativa per altre.</span><span class="sxs-lookup"><span data-stu-id="f9468-159">Fiscal registration might be mandatory for some operations but optional for others.</span></span> <span data-ttu-id="f9468-160">Ad esempio, la registrazione fiscale di vendite e resi normali potrebbe essere obbligatoria, ma la registrazione fiscale delle operazioni correlate ai depositi cliente potrebbe essere facoltativa.</span><span class="sxs-lookup"><span data-stu-id="f9468-160">For example, the fiscal registration of regular sales and returns might be mandatory, but the fiscal registration of operations that are related to customer deposits might be optional.</span></span> <span data-ttu-id="f9468-161">In questo caso, il mancato completamento della registrazione fiscale di una vendita deve bloccare ulteriori vendite, ma il mancato completamento della registrazione fiscale di deposito cliente non deve bloccare ulteriori vendite.</span><span class="sxs-lookup"><span data-stu-id="f9468-161">In this case, failure to complete the fiscal registration of a sale should block further sales, but failure to complete the fiscal registration of a customer deposit should not block further sales.</span></span> <span data-ttu-id="f9468-162">Per distinguere le operazioni obbligatorie e facoltative, si consiglia di gestirle tramite differenti fornitori di documenti e di configurare passaggi distinti nel processo di registrazione fiscale per quei fornitori.</span><span class="sxs-lookup"><span data-stu-id="f9468-162">To distinguish mandatory and optional operations, we recommend that you handle them through different document providers, and that you set up separate steps in the fiscal registration process for those providers.</span></span> <span data-ttu-id="f9468-163">Il parametro **Continua in caso di errore** deve essere abilitato per qualsiasi passaggio correlato alla registrazione fiscale facoltativa.</span><span class="sxs-lookup"><span data-stu-id="f9468-163">The **Continue on error** parameter should be enabled for any step that is related to optional fiscal registration.</span></span> <span data-ttu-id="f9468-164">Per ulteriori informazioni su come impostare i parametri di gestione degli errori, vedere [Configurare le impostazioni di gestione degli errori](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="f9468-164">For more details about how to set up error handling parameters, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

### <a name="manually-running-fiscal-registration"></a><span data-ttu-id="f9468-165">Esecuzione manuale della registrazione fiscale</span><span class="sxs-lookup"><span data-stu-id="f9468-165">Manually running fiscal registration</span></span>

<span data-ttu-id="f9468-166">Se la registrazione fiscale di una transazione o di un evento è stata posticipata dopo un errore (ad esempio se l'operatore ha selezionato **Annulla** nella finestra di dialogo di gestione degli errori), è possibile rieseguire manualmente la registrazione fiscale invocando un'operazione corrispondente.</span><span class="sxs-lookup"><span data-stu-id="f9468-166">If the fiscal registration of a transaction or event has been postponed after a failure (for example, if the operator selected **Cancel** in the error handling dialog box), you can manually rerun the fiscal registration by invoking a corresponding operation.</span></span> <span data-ttu-id="f9468-167">Per ulteriori dettagli, vedere [Abilitare l'esecuzione manuale della registrazione fiscale posticipata](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span><span class="sxs-lookup"><span data-stu-id="f9468-167">For more details, see [Enable manual execution of postponed fiscal registration](setting-up-fiscal-integration-for-retail-channel.md#enable-manual-execution-of-postponed-fiscal-registration).</span></span>

### <a name="fiscal-registration-health-check"></a><span data-ttu-id="f9468-168">Verifica integrità della registrazione fiscale</span><span class="sxs-lookup"><span data-stu-id="f9468-168">Fiscal registration health check</span></span>

<span data-ttu-id="f9468-169">La procedura di verifica integrità per le registrazioni fiscali verifica la disponibilità del dispositivo o del servizio fiscale quando si verificano specifici eventi.</span><span class="sxs-lookup"><span data-stu-id="f9468-169">The health check procedure for fiscal registrations verifies the availability of the fiscal device or service when specific events occur.</span></span> <span data-ttu-id="f9468-170">Se la registrazione fiscale non può essere completata sul momento, l'operatore viene avvisato in anticipo.</span><span class="sxs-lookup"><span data-stu-id="f9468-170">If the fiscal registration can't currently be completed, the operator is notified in advance.</span></span>

<span data-ttu-id="f9468-171">Il POS esegue la verifica integrità quando si verificano i seguenti eventi:</span><span class="sxs-lookup"><span data-stu-id="f9468-171">The POS runs the health check when the following events occur:</span></span>

- <span data-ttu-id="f9468-172">Viene aperta una nuova transazione.</span><span class="sxs-lookup"><span data-stu-id="f9468-172">A new transaction is opened.</span></span>
- <span data-ttu-id="f9468-173">Viene richiamata una transazione sospesa.</span><span class="sxs-lookup"><span data-stu-id="f9468-173">A suspended transaction is recalled.</span></span>
- <span data-ttu-id="f9468-174">Viene finalizzata una transazione di vendita o reso.</span><span class="sxs-lookup"><span data-stu-id="f9468-174">A sales or return transaction is finalized.</span></span>

<span data-ttu-id="f9468-175">Se la verifica integrità non riesce, il POS visualizza la finestra di dialogo della verifica integrità.</span><span class="sxs-lookup"><span data-stu-id="f9468-175">If the health check fails, the POS shows the health check dialog box.</span></span> <span data-ttu-id="f9468-176">Questa finestra di dialogo fornisce i pulsanti seguenti:</span><span class="sxs-lookup"><span data-stu-id="f9468-176">This dialog box provides the following buttons:</span></span>

- <span data-ttu-id="f9468-177">**OK** - Questo pulsante consente all'operatore di ignorare l'errore della verifica integrità e di continuare a elaborare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="f9468-177">**OK** – This button lets the operator ignore a health check error and continue to process the operation.</span></span> <span data-ttu-id="f9468-178">Gli operatori possono selezionare questo pulsante solo se l'autorizzazione **Consenti di ignorare l'errore di verifica integrità** è attivata.</span><span class="sxs-lookup"><span data-stu-id="f9468-178">Operators can select this button only if the **Allow skip health check error** permission is enabled for them.</span></span>
- <span data-ttu-id="f9468-179">**Annulla** - Se l'operatore seleziona questo pulsante, il POS annulla l'ultima azione (ad esempio un articolo non viene aggiunto a una nuova transazione).</span><span class="sxs-lookup"><span data-stu-id="f9468-179">**Cancel** – If the operator selects this button, the POS cancels the last action (for example, an item isn't added to a new transaction).</span></span>

> [!NOTE]
> <span data-ttu-id="f9468-180">La verifica integrità viene eseguita solo se l'operazione corrente richiede la registrazione fiscale e se il parametro **Continua in caso di errore** è disabilitata per il passaggio corrente del processo di registrazione fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-180">The health check is run only if the current operation requires fiscal registration, and if  the **Continue on error** parameter is disabled for the current step of the fiscal registration process.</span></span> <span data-ttu-id="f9468-181">Per ulteriori informazioni, vedere [Configurare le impostazioni di gestione degli errori](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span><span class="sxs-lookup"><span data-stu-id="f9468-181">For more details, see [Set error handling settings](setting-up-fiscal-integration-for-retail-channel.md#set-error-handling-settings).</span></span>

## <a name="storing-fiscal-response-in-fiscal-transaction"></a><span data-ttu-id="f9468-182">Archiviazione della risposta fiscale nella transazione fiscale</span><span class="sxs-lookup"><span data-stu-id="f9468-182">Storing fiscal response in fiscal transaction</span></span>

<span data-ttu-id="f9468-183">Quando la registrazione fiscale di una transazione o di un evento ha esito positivo, una transazione fiscale viene creata nel database del canale e collegata alla transazione o all'evento originale.</span><span class="sxs-lookup"><span data-stu-id="f9468-183">When fiscal registration of a transaction or event is successful, a fiscal transaction is created in the channel database and linked to the original transaction or event.</span></span> <span data-ttu-id="f9468-184">Analogamente, se l'opzione **Ignora** o **Contrassegna come registrato** è selezionata per una registrazione fiscale non riuscita, queste informazioni vengono archiviate in una transazione fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-184">Similarly, if the **Skip** or **Mark as registered** option is selected for a failed fiscal registration, this information is stored in a fiscal transaction.</span></span> <span data-ttu-id="f9468-185">Una transazione fiscale include la risposta fiscale del dispositivo o del servizio fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-185">A fiscal transaction holds the fiscal response of the fiscal device or service.</span></span> <span data-ttu-id="f9468-186">Se il processo di registrazione fiscale comporta varie fasi, una transazione fiscale viene creata per ogni fase del processo che ha generato una registrazione riuscita o non riuscita.</span><span class="sxs-lookup"><span data-stu-id="f9468-186">If the fiscal registration process consists of several steps, a fiscal transaction is created for each step of the process that resulted in a successful or failed registration.</span></span>

<span data-ttu-id="f9468-187">Le transazioni fiscali vengono trasferite a Headquarters dal *processo P*, insieme alle transazioni.</span><span class="sxs-lookup"><span data-stu-id="f9468-187">Fiscal transactions are transferred to Headquarters by the *P-job*, together with transactions.</span></span> <span data-ttu-id="f9468-188">Nella scheda Dettaglio **Transazioni fiscali** della pagina **Transazioni punto vendita**, è possibile visualizzare le transazioni fiscali collegate alle transazioni di vendita al dettaglio.</span><span class="sxs-lookup"><span data-stu-id="f9468-188">On the **Fiscal transactions** FastTab of the **Store transactions** page, you can view the fiscal transactions that are linked to transactions.</span></span>

<span data-ttu-id="f9468-189">Una transazione fiscale archivia i seguenti dettagli:</span><span class="sxs-lookup"><span data-stu-id="f9468-189">A fiscal transaction stores the following details:</span></span>

- <span data-ttu-id="f9468-190">Dettagli del processo di registrazione fiscale (processo, gruppo di connettori, connettore e così via).</span><span class="sxs-lookup"><span data-stu-id="f9468-190">Fiscal registration process details (process, connector group, connector, and so on).</span></span> <span data-ttu-id="f9468-191">Archivia inoltre il numero di serie del dispositivo fiscale nel campo **Numero registratore di cassa**, se queste informazioni sono incluse nella risposta fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-191">It also stores the serial number of the fiscal device in the **Register number** field, if this information is included in the fiscal response.</span></span>
- <span data-ttu-id="f9468-192">Lo stato della registrazione fiscale: **Completata** per una registrazione fiscale riuscita, **Ignorata** se l'operatore ha selezionato l'opzione **Ignora** per una registrazione non riuscita o **Contrassegnata come registrata** se l'operatore ha selezionato l'opzione **Contrassegna come registrata**.</span><span class="sxs-lookup"><span data-stu-id="f9468-192">The status of the fiscal registration: **Completed** for successful registration, **Skipped** if the operator selected the **Skip** option for a failed registration, or **Marked as registered** if the operator selected the **Mark as registered** option.</span></span>
- <span data-ttu-id="f9468-193">Transazioni codice informativo correlate a una transazione fiscale selezionata.</span><span class="sxs-lookup"><span data-stu-id="f9468-193">Info code transactions that are related to a selected fiscal transaction.</span></span> <span data-ttu-id="f9468-194">Per visualizzare le transazioni codice informativo, nella scheda Dettaglio **Transazioni fiscali**, selezionare una transazione fiscale con stato **Ignorata** o **Contrassegnata come registrata** e quindi selezionare **Transazioni codice informativo**.</span><span class="sxs-lookup"><span data-stu-id="f9468-194">To view the info code transactions, on the **Fiscal transactions** FastTab, select a fiscal transaction that has a status of **Skipped** or **Marked as registered**, and then select **Info code transactions**.</span></span>

## <a name="fiscal-texts-for-discounts"></a><span data-ttu-id="f9468-195">Testi fiscali per sconti</span><span class="sxs-lookup"><span data-stu-id="f9468-195">Fiscal texts for discounts</span></span>

<span data-ttu-id="f9468-196">Alcuni paesi o aree geografiche hanno requisiti speciali su testi aggiuntivi che devono essere stampati sulle ricevute fiscali quando diversi tipi di sconti vengono applicati.</span><span class="sxs-lookup"><span data-stu-id="f9468-196">Some countries or regions have special requirements about additional texts that must be printed on fiscal receipts when different kinds of discounts are applied.</span></span> <span data-ttu-id="f9468-197">La funzionalità di integrazione fiscale consente di impostare un testo speciale per uno sconto che viene stampato dopo una riga di sconto su una ricevuta fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-197">The fiscal integration functionality lets you set up a special text for a discount that is printed after a discount line on a fiscal receipt.</span></span> <span data-ttu-id="f9468-198">Per gli sconti manuali, è possibile configurare un testo fiscale per il codice informativo specificato come codice informativo **Sconto prodotti** nel profilo funzionalità POS.</span><span class="sxs-lookup"><span data-stu-id="f9468-198">For manual discounts, you can configure a fiscal text for the info code that is specified as the **Product discount** info code in the POS functionality profile.</span></span> <span data-ttu-id="f9468-199">Per ulteriori informazioni su come impostare testi fiscali per gli sconti, vedere [Impostare testi fiscali per sconti](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span><span class="sxs-lookup"><span data-stu-id="f9468-199">For more details about how to set up fiscal texts for discounts, see [Set up fiscal texts for discounts](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-texts-for-discounts).</span></span>

## <a name="printing-fiscal-x-and-fiscal-z-reports"></a><span data-ttu-id="f9468-200">Stampa di report X e Z fiscali</span><span class="sxs-lookup"><span data-stu-id="f9468-200">Printing fiscal X and fiscal Z reports</span></span>

<span data-ttu-id="f9468-201">La funzionalità di integrazione fiscale supporta la generazione di rendiconti giornalieri specifici al dispositivo o al servizio fiscale integrato:</span><span class="sxs-lookup"><span data-stu-id="f9468-201">Fiscal integration functionality supports generation of end-of-day statements that are specific to the integrated fiscal device or service:</span></span>

- <span data-ttu-id="f9468-202">I nuovi pulsanti che eseguono le operazioni corrispondenti devono essere aggiunti al layout dello schermo POS.</span><span class="sxs-lookup"><span data-stu-id="f9468-202">New buttons that run corresponding operations should be added to the POS screen layout.</span></span> <span data-ttu-id="f9468-203">Per ulteriori informazioni, vedere [Configurare report X/Z fiscali dal POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span><span class="sxs-lookup"><span data-stu-id="f9468-203">For more details, see [Set up fiscal X/Z reports from the POS](setting-up-fiscal-integration-for-retail-channel.md#set-up-fiscal-xz-reports-from-the-pos).</span></span>
- <span data-ttu-id="f9468-204">Nell'esempio di integrazione fiscale, queste operazioni devono corrispondere alle relative operazioni del dispositivo fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-204">In the fiscal integration sample, these operations should be matched to the corresponding operations of the fiscal device.</span></span>

## <a name="fiscal-integration-samples-in-the-retail-sdk"></a><span data-ttu-id="f9468-205">Esempi di integrazione fiscale in Retail SDK</span><span class="sxs-lookup"><span data-stu-id="f9468-205">Fiscal integration samples in the Retail SDK</span></span>

<span data-ttu-id="f9468-206">I seguenti esempi di integrazione fiscale sono attualmente disponibili nel Retail SDK:</span><span class="sxs-lookup"><span data-stu-id="f9468-206">The following fiscal integration samples are currently available in the Retail SDK:</span></span>

- [<span data-ttu-id="f9468-207">Esempio di integrazione di stampante fiscale per l'Italia</span><span class="sxs-lookup"><span data-stu-id="f9468-207">Fiscal printer integration sample for Italy</span></span>](emea-ita-fpi-sample.md)
- [<span data-ttu-id="f9468-208">Esempio di integrazione di stampante fiscale per la Polonia</span><span class="sxs-lookup"><span data-stu-id="f9468-208">Fiscal printer integration sample for Poland</span></span>](emea-pol-fpi-sample.md)
- [<span data-ttu-id="f9468-209">Esempio di integrazione del servizio di registrazione fiscale per l'Austria</span><span class="sxs-lookup"><span data-stu-id="f9468-209">Fiscal registration service integration sample for Austria</span></span>](emea-aut-fi-sample.md)
- [<span data-ttu-id="f9468-210">Esempio di integrazione del servizio di registrazione fiscale per la Repubblica Ceca</span><span class="sxs-lookup"><span data-stu-id="f9468-210">Fiscal registration service integration sample for Czech Republic</span></span>](emea-cze-fi-sample.md)
- [<span data-ttu-id="f9468-211">Esempio di integrazione di un'unità di controllo per la Svezia</span><span class="sxs-lookup"><span data-stu-id="f9468-211">Control unit integration sample for Sweden</span></span>](./emea-swe-fi-sample.md)
- [<span data-ttu-id="f9468-212">Esempio di integrazione del servizio di registrazione fiscale per la Germania</span><span class="sxs-lookup"><span data-stu-id="f9468-212">Fiscal registration service integration sample for Germany</span></span>](./emea-deu-fi-sample.md)

<span data-ttu-id="f9468-213">La seguente funzionalità di integrazione fiscale è disponibile anche in Retail SDK ma attualmente non utilizza il framework di integrazione fiscale.</span><span class="sxs-lookup"><span data-stu-id="f9468-213">The following fiscal integration functionality is also available in the Retail SDK but doesn't currently take advantage of the fiscal integration framework.</span></span> <span data-ttu-id="f9468-214">La migrazione di questa funzionalità al framework di integrazione fiscale è prevista negli aggiornamenti successivi.</span><span class="sxs-lookup"><span data-stu-id="f9468-214">Migration of this functionality to the fiscal integration framework is planned for later updates.</span></span>


- [<span data-ttu-id="f9468-215">Firma digitale per la Francia</span><span class="sxs-lookup"><span data-stu-id="f9468-215">Digital signature for France</span></span>](emea-fra-cash-registers.md)
- [<span data-ttu-id="f9468-216">Firma digitale per la Norvegia</span><span class="sxs-lookup"><span data-stu-id="f9468-216">Digital signature for Norway</span></span>](emea-nor-cash-registers.md)

<span data-ttu-id="f9468-217">La seguente funzionalità di integrazione fiscale legacy disponibile in Retail SDK non utilizza il framework di integrazione fiscale e sarà deprecata negli aggiornamenti successivi:</span><span class="sxs-lookup"><span data-stu-id="f9468-217">The following legacy fiscal integration functionality that is available in Retail SDK does not use the fiscal integration framework and will be deprecated in later updates:</span></span>

- [<span data-ttu-id="f9468-218">Esempio di integrazione di un'unità di controllo per la Svezia (legacy)</span><span class="sxs-lookup"><span data-stu-id="f9468-218">Control unit integration sample for Sweden (legacy)</span></span>](./retail-sdk-control-unit-sample.md)


[!INCLUDE[footer-include](../../includes/footer-banner.md)]