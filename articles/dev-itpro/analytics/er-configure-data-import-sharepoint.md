---
title: Configurare l'importazione di dati da SharePoint
description: In questo argomento viene descritto come importare i dati da Microsoft SharePoint.
author: NickSelin
manager: AnnBe
ms.date: 11/29/2018
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.openlocfilehash: 1c6e868920e5b83b33b1409c6551506fb7aeba51
ms.sourcegitcommit: 16bfa0fd08feec1647829630401ce62ce2ffa1a4
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 08/02/2019
ms.locfileid: "1849713"
---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="897e5-103">Configurare l'importazione di dati da SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="897e5-104">Per importare dati da un file ricevuto utilizzando il framework di creazione di report elettronici (ER, electronic reporting), è necessario configurare un formato di ER che supporti l'importazione e quindi eseguire il mapping di modello del tipo **A destinazione** che utilizza quel formato come origine dati.</span><span class="sxs-lookup"><span data-stu-id="897e5-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="897e5-105">Per importare i dati, è necessario passare al file da importare.</span><span class="sxs-lookup"><span data-stu-id="897e5-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="897e5-106">Il file ricevuto può essere selezionato manualmente dall'utente.</span><span class="sxs-lookup"><span data-stu-id="897e5-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="897e5-107">Con la nuova funzionalità di ER per supportare l'importazione dei dati da Microsoft SharePoint, questo processo può essere configurato come automatico.</span><span class="sxs-lookup"><span data-stu-id="897e5-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as unattended.</span></span> <span data-ttu-id="897e5-108">È possibile utilizzare le configurazioni di ER per eseguire l'importazione di dati dai file che sono archiviati in cartelle di Microsoft SharePoint.</span><span class="sxs-lookup"><span data-stu-id="897e5-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="897e5-109">In questo argomento viene descritto come completare l'importazione da SharePoint in Microsoft Dynamics 365 for Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="897e5-109">This topic explains how to complete the import from SharePoint to Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="897e5-110">Gli esempi utilizzano transazioni fornitore come dati aziendali.</span><span class="sxs-lookup"><span data-stu-id="897e5-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="897e5-111">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="897e5-111">Prerequisites</span></span>
<span data-ttu-id="897e5-112">Per completare gli esempi in questo argomento, è necessario disporre del seguente accesso:</span><span class="sxs-lookup"><span data-stu-id="897e5-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="897e5-113">Accesso a Finance and Operations per uno dei seguenti ruoli:</span><span class="sxs-lookup"><span data-stu-id="897e5-113">Access to Finance and Operations for one of the following roles:</span></span>

    - <span data-ttu-id="897e5-114">Sviluppatore per la creazione di report elettronici</span><span class="sxs-lookup"><span data-stu-id="897e5-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="897e5-115">Consulente funzionale per la creazione di report elettronici</span><span class="sxs-lookup"><span data-stu-id="897e5-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="897e5-116">Amministratore di sistema</span><span class="sxs-lookup"><span data-stu-id="897e5-116">System administrator</span></span>

- <span data-ttu-id="897e5-117">Accesso all'istanza di Microsoft SharePoint Server configurato per l'utilizzo con Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="897e5-117">Access to the instance of Microsoft SharePoint Server that is configured for use with Finance and Operations.</span></span>
- <span data-ttu-id="897e5-118">Configurazioni di formato ER e di modello per 1099 pagamenti.</span><span class="sxs-lookup"><span data-stu-id="897e5-118">ER format and model configurations for 1099 payments.</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="897e5-119">Creare le configurazioni di ER richieste</span><span class="sxs-lookup"><span data-stu-id="897e5-119">Create required ER configurations</span></span>
<span data-ttu-id="897e5-120">Riprodurre le guide attività **ER Importare i data da un file di Microsoft Excel**, che fanno parte del processo aziendale **7.5.4.3 Acquisire/sviluppare componenti di soluzioni/servizi IT (10677)**.</span><span class="sxs-lookup"><span data-stu-id="897e5-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="897e5-121">Queste guide attività illustrano in dettaglio il processo di progettazione e di utilizzo delle configurazioni ER per importare in modo interattivo transazioni fornitori da file di Microsoft Excel.</span><span class="sxs-lookup"><span data-stu-id="897e5-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from Microsoft Excel files.</span></span> <span data-ttu-id="897e5-122">Per ulteriori informazioni, vedere [Analizzare i documenti ricevuti in Microsoft Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="897e5-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="897e5-123">Dopo aver completato le guide di attività, si avrà la configurazione seguente.</span><span class="sxs-lookup"><span data-stu-id="897e5-123">After you have completed the task guides, you will have the following set up.</span></span>

#### <a name="er-configurations"></a><span data-ttu-id="897e5-124">Configurazioni ER</span><span class="sxs-lookup"><span data-stu-id="897e5-124">ER configurations</span></span>

- <span data-ttu-id="897e5-125">Configurazione del modello di ER, **1099 Modello pagamenti**</span><span class="sxs-lookup"><span data-stu-id="897e5-125">ER model configuration, **1099 Payments model**</span></span>
- <span data-ttu-id="897e5-126">Configurazione del formato per ER, **Formato per importare transazioni fornitori da Excel**</span><span class="sxs-lookup"><span data-stu-id="897e5-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

![Configurazioni di ER per importare i dati da SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a><span data-ttu-id="897e5-128">Esempio di file ricevuto per l'importazione dei dati</span><span class="sxs-lookup"><span data-stu-id="897e5-128">Sample of the incoming file for data import</span></span>

- <span data-ttu-id="897e5-129">File di Excel **1099import-data.xlsx**, con transazioni fornitori che devono essere importate in Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="897e5-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported into Finance and Operations.</span></span>

![Esempio di file di Microsoft Excel per l'importazione da SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> <span data-ttu-id="897e5-131">Il formato per l'importazione delle transazioni fornitori è selezionato come mapping di modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="897e5-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="897e5-132">Se quindi si esegue un mapping di modello del **1099 modello pagamenti** e quel mapping di modello è di tipo **A destinazione**, il mapping di modello esegue questo formato per importare i dati da file esterni.</span><span class="sxs-lookup"><span data-stu-id="897e5-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="897e5-133">Utilizza quindi i dati per aggiornare le tabelle dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="897e5-133">It then uses that data to update application tables.</span></span>

## <a name="configure-access-to-sharepoint-for-file-storage"></a><span data-ttu-id="897e5-134">Configurare l'accesso a SharePoint per l'archiviazione dei file</span><span class="sxs-lookup"><span data-stu-id="897e5-134">Configure access to SharePoint for file storage</span></span>
<span data-ttu-id="897e5-135">Per archiviare i file di report elettronici in un percorso di SharePoint, è necessario configurare l'accesso all'istanza di SharePoint Server che verrà utilizzato dalla società corrente.</span><span class="sxs-lookup"><span data-stu-id="897e5-135">To store electronic report files in a SharePoint location, you must configure access to the SharePoint Server instance that will be used by the current company.</span></span> <span data-ttu-id="897e5-136">In questo esempio, la società è USMF.</span><span class="sxs-lookup"><span data-stu-id="897e5-136">In this example, the company is USMF.</span></span> <span data-ttu-id="897e5-137">Per istruzioni, vedere [Configurazione dell'archiviazione di SharePoint](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="897e5-137">For instructions, see [Configure SharePoint storage](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>

1. <span data-ttu-id="897e5-138">Completare i passaggi in [Configurazione dell'archiviazione di SharePoint](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span><span class="sxs-lookup"><span data-stu-id="897e5-138">Complete the steps in [Configure SharePoint storage](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).</span></span>
2. <span data-ttu-id="897e5-139">Aprire il sito di SharePoint configurato.</span><span class="sxs-lookup"><span data-stu-id="897e5-139">Open the configured SharePoint site.</span></span>
3. <span data-ttu-id="897e5-140">Creare le seguenti cartelle dove è possibile archiviare i file di report elettronici in arrivo:</span><span class="sxs-lookup"><span data-stu-id="897e5-140">Create the following folders where incoming electronic reporting files can be stored:</span></span>

     - <span data-ttu-id="897e5-141">Origine di importazione dei file (principale) (esempio mostrato nella schermata seguente)</span><span class="sxs-lookup"><span data-stu-id="897e5-141">Files import source (main) (Example shown in screenshot below)</span></span>
     - <span data-ttu-id="897e5-142">Origine di importazione dei file (alternativa)</span><span class="sxs-lookup"><span data-stu-id="897e5-142">Files import source (alternative)</span></span>

    ![Origine di importazione dei file (principale)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. <span data-ttu-id="897e5-144">(Facoltativo) Creare le seguenti cartelle dove è possibile archiviare i file dopo l'importazione.</span><span class="sxs-lookup"><span data-stu-id="897e5-144">(Optional) Create the following folders where the files can be stored after import.</span></span> 

    - <span data-ttu-id="897e5-145">Cartella di archiviazione dei file – Questa cartella è per i file importati correttamente.</span><span class="sxs-lookup"><span data-stu-id="897e5-145">Files archive folder - This folder would be for successfully imported files.</span></span>
    - <span data-ttu-id="897e5-146">Cartella di avvisi dei file – Questa cartella è per i file importati con un avviso.</span><span class="sxs-lookup"><span data-stu-id="897e5-146">Files warning folder - This folder would be for files that were imported with a warning.</span></span>
    - <span data-ttu-id="897e5-147">Cartella di errori dei file – Questa cartella è per i file la cui importazione non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="897e5-147">Files error folder - This folder would be for files that failed to import.</span></span>

4. <span data-ttu-id="897e5-148">In Finance and Operations, andare a **Amministrazione organizzazione > Gestione documenti > Tipi di documento**.</span><span class="sxs-lookup"><span data-stu-id="897e5-148">In Finance and Operations, go to **Organization administration > Document management > Document types**.</span></span>
5. <span data-ttu-id="897e5-149">Creare i tipi di documento seguenti che verranno utilizzati per accedere alle cartelle di SharePoint appena create.</span><span class="sxs-lookup"><span data-stu-id="897e5-149">Create the following document types that will be used to access the SharePoint folders that you just created.</span></span> <span data-ttu-id="897e5-150">Per istruzioni, vedere [Configurare i tipi di documento](../../fin-and-ops/organization-administration/configure-document-management.md#configure-document-types).</span><span class="sxs-lookup"><span data-stu-id="897e5-150">For instructions, see [Configure document types](../../fin-and-ops/organization-administration/configure-document-management.md#configure-document-types).</span></span>

|<span data-ttu-id="897e5-151">Tipo di documento</span><span class="sxs-lookup"><span data-stu-id="897e5-151">Document type</span></span>       | <span data-ttu-id="897e5-152">Raggruppa</span><span class="sxs-lookup"><span data-stu-id="897e5-152">Group</span></span>              | <span data-ttu-id="897e5-153">Posizione</span><span class="sxs-lookup"><span data-stu-id="897e5-153">Location</span></span>      | <span data-ttu-id="897e5-154">Cartella SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-154">SharePoint folder</span></span>      |
|--------------------|--------------------|---------------|------------------------|
|<span data-ttu-id="897e5-155">Principale di SP</span><span class="sxs-lookup"><span data-stu-id="897e5-155">SP Main</span></span>             |<span data-ttu-id="897e5-156">File</span><span class="sxs-lookup"><span data-stu-id="897e5-156">File</span></span>                |<span data-ttu-id="897e5-157">SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-157">SharePoint</span></span>     |<span data-ttu-id="897e5-158">Origine di importazione dei file (principale)</span><span class="sxs-lookup"><span data-stu-id="897e5-158">Files import source (main)</span></span>|
|<span data-ttu-id="897e5-159">Alternativa di SP</span><span class="sxs-lookup"><span data-stu-id="897e5-159">SP Alternative</span></span>             |<span data-ttu-id="897e5-160">File</span><span class="sxs-lookup"><span data-stu-id="897e5-160">File</span></span>                |<span data-ttu-id="897e5-161">SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-161">SharePoint</span></span>     |<span data-ttu-id="897e5-162">Origine di importazione dei file (alternativa)</span><span class="sxs-lookup"><span data-stu-id="897e5-162">Files import source (alternative)</span></span>|
|<span data-ttu-id="897e5-163">Archivio SP</span><span class="sxs-lookup"><span data-stu-id="897e5-163">SP Archive</span></span>             |<span data-ttu-id="897e5-164">File</span><span class="sxs-lookup"><span data-stu-id="897e5-164">File</span></span>                |<span data-ttu-id="897e5-165">SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-165">SharePoint</span></span>     |<span data-ttu-id="897e5-166">Cartella di archiviazione dei file</span><span class="sxs-lookup"><span data-stu-id="897e5-166">Files archive folder</span></span>|
|<span data-ttu-id="897e5-167">Avviso SP</span><span class="sxs-lookup"><span data-stu-id="897e5-167">SP Warning</span></span>             |<span data-ttu-id="897e5-168">File</span><span class="sxs-lookup"><span data-stu-id="897e5-168">File</span></span>                |<span data-ttu-id="897e5-169">SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-169">SharePoint</span></span>     |<span data-ttu-id="897e5-170">Cartella di avvisi dei file</span><span class="sxs-lookup"><span data-stu-id="897e5-170">Files warning folder</span></span>|
|<span data-ttu-id="897e5-171">Errore SP</span><span class="sxs-lookup"><span data-stu-id="897e5-171">SP Error</span></span>             |<span data-ttu-id="897e5-172">File</span><span class="sxs-lookup"><span data-stu-id="897e5-172">File</span></span>                |<span data-ttu-id="897e5-173">SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-173">SharePoint</span></span>     |<span data-ttu-id="897e5-174">Cartella di errori dei file</span><span class="sxs-lookup"><span data-stu-id="897e5-174">Files error folder</span></span>|

![Impostazione di SharePoint - nuovo tipo di documento](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="897e5-176">Configurare le origini di ER per il formato di ER</span><span class="sxs-lookup"><span data-stu-id="897e5-176">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="897e5-177">Fare clic su **Amministrazione organizzazione** \> **Creazione di report elettronici** \> **Origine creazione di report elettronici**.</span><span class="sxs-lookup"><span data-stu-id="897e5-177">Click **Organization administration** \> **Electronic reporting** \> **Electronic reporting source**.</span></span>
2. <span data-ttu-id="897e5-178">Nella pagina **Origine creazione di report elettronici** configurare i file di origine per l'importazione dei dati utilizzando il formato di ER configurato.</span><span class="sxs-lookup"><span data-stu-id="897e5-178">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="897e5-179">Definire una maschera del nome di file, in modo che solo i file con estensione xlsx vengano importati.</span><span class="sxs-lookup"><span data-stu-id="897e5-179">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="897e5-180">La maschera del nome di file è facoltativa e viene utilizzata solo quando è stata definita.</span><span class="sxs-lookup"><span data-stu-id="897e5-180">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="897e5-181">È possibile definire una sola maschera per ogni formato di ER.</span><span class="sxs-lookup"><span data-stu-id="897e5-181">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="897e5-182">Modificare **Ordina i file prima di importare** in **Non ordinare** se vi sono molti file da importare e l'ordine di importazione non è importante</span><span class="sxs-lookup"><span data-stu-id="897e5-182">Change **Sort files before import** to **Do not sort**, if there are a lot of files for import and the import order is not important</span></span>
5. <span data-ttu-id="897e5-183">Selezionare tutte le cartelle di SharePoint create in precedenza.</span><span class="sxs-lookup"><span data-stu-id="897e5-183">Select all SharePoint folders that you created earlier.</span></span>

    <span data-ttu-id="897e5-184">[![Impostazione dell'origine dei file di ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-184">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
> - <span data-ttu-id="897e5-185">L'*origine* di ER viene definita per ogni società dell'applicazione individualmente.</span><span class="sxs-lookup"><span data-stu-id="897e5-185">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="897e5-186">Le *configurazioni* di ER vengono invece condivise tra le società.</span><span class="sxs-lookup"><span data-stu-id="897e5-186">By contrast, ER *configurations* are shared across companies.</span></span>
> - <span data-ttu-id="897e5-187">Quando si elimina un'impostazione di origine di ER per un formato di ER, vengono eliminati anche tutti gli stati dei file connessi (vedere sotto) dietro conferma.</span><span class="sxs-lookup"><span data-stu-id="897e5-187">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted by confirmation.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="897e5-188">Esaminare gli stati dei file per il formato di ER</span><span class="sxs-lookup"><span data-stu-id="897e5-188">Review the files states for the ER format</span></span>
1. <span data-ttu-id="897e5-189">Nella pagina **Origine creazione di report elettronici** selezionare **Stati dei file per le origini** per esaminare il contenuto delle origini dei file configurate per il formato di ER corrente.</span><span class="sxs-lookup"><span data-stu-id="897e5-189">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="897e5-190">Nella sezione **File** esaminare l'elenco dei file.</span><span class="sxs-lookup"><span data-stu-id="897e5-190">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="897e5-191">Questo elenco presenta gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="897e5-191">This list presents the following:</span></span>

    - <span data-ttu-id="897e5-192">File di origine applicabili, in base alla maschera del nome di file (se viene definita una maschera del nome di file), e pronti per l'importazione di dati.</span><span class="sxs-lookup"><span data-stu-id="897e5-192">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="897e5-193">Per tali file, la sezione **Registri delle origini per il formato di importazione** è vuota.</span><span class="sxs-lookup"><span data-stu-id="897e5-193">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="897e5-194">File precedentemente importati.</span><span class="sxs-lookup"><span data-stu-id="897e5-194">Previously imported files.</span></span> <span data-ttu-id="897e5-195">Per ognuno di questi file, nella sezione **Registri delle origini per il formato di importazione** è possibile esaminare la cronologia di importazione del file.</span><span class="sxs-lookup"><span data-stu-id="897e5-195">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="897e5-196">È inoltre possibile aprire la pagina **Stati dei file per le origini** selezionando **Amministrazione organizzazione** \> **Creazione di report elettronici** \> **Stati dei file per le origini**.</span><span class="sxs-lookup"><span data-stu-id="897e5-196">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="897e5-197">In questo caso, la pagina fornisce informazioni sulle origini dei file per tutti i formati di ER per cui sono state configurate le origini dei file nella società a cui si è attualmente connessi.</span><span class="sxs-lookup"><span data-stu-id="897e5-197">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="897e5-198">Importare dati da file di Excel in una cartella di SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-198">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="897e5-199">In SharePoint, caricare il file di Microsoft Excel denominato **1099import-data.xlsx**, contenente le transazioni fornitori, nella cartella di SharePoint **Origine di importazione dei file (principale)** creata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="897e5-199">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

    <span data-ttu-id="897e5-200">[![Contenuto di SharePoint - file di Microsoft Excel per l'importazione](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="897e5-200">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="897e5-201">In Finance and Operations, nella pagina **Stati dei file per le origini** selezionare **Aggiorna** per aggiornare la pagina.</span><span class="sxs-lookup"><span data-stu-id="897e5-201">In Finance and Operations, on the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="897e5-202">Si noti che il file di Excel che è stato caricato in SharePoint viene visualizzato in questa pagina con lo stato **Pronto**.</span><span class="sxs-lookup"><span data-stu-id="897e5-202">Note that the Excel file that was uploaded to SharePoint appeared on this page with the status **Ready**.</span></span> <span data-ttu-id="897e5-203">Al momento sono disponibili i seguenti stati:</span><span class="sxs-lookup"><span data-stu-id="897e5-203">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="897e5-204">**Pronto** - Assegnato automaticamente per ogni nuovo file in una cartella di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="897e5-204">**Ready** – Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="897e5-205">Questo stato indica che il file è pronto per l'importazione.</span><span class="sxs-lookup"><span data-stu-id="897e5-205">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="897e5-206">**Importazione** - Assegnato automaticamente da un report di ER quando il file viene bloccato dal processo di importazione per impedirne l'utilizzo da parte di altri processi (nel caso in cui vengano eseguiti più processi contemporaneamente).</span><span class="sxs-lookup"><span data-stu-id="897e5-206">**Importing** – Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="897e5-207">**Importato** - Assegnato automaticamente da un report di ER al termine della corretta importazione di file.</span><span class="sxs-lookup"><span data-stu-id="897e5-207">**Imported** – Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="897e5-208">Questo stato indica che il file importato è stato eliminato dall'origine di file configurata (cartella di SharePoint).</span><span class="sxs-lookup"><span data-stu-id="897e5-208">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="897e5-209">**Non riuscito** - Assegnato automaticamente da un report di ER quando l'importazione dei file genera errori o eccezioni.</span><span class="sxs-lookup"><span data-stu-id="897e5-209">**Failed** – Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="897e5-210">**In attesa** - Assegnato manualmente dall'utente in questa pagina.</span><span class="sxs-lookup"><span data-stu-id="897e5-210">**On hold** – Assigned manually by user on this page.</span></span> <span data-ttu-id="897e5-211">Questo stato indica che il file non verrà importato per il momento.</span><span class="sxs-lookup"><span data-stu-id="897e5-211">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="897e5-212">Questo stato può essere utilizzato per posticipare l'importazione di alcuni file.</span><span class="sxs-lookup"><span data-stu-id="897e5-212">This status can be used to postpone the import of some files.</span></span>

    <span data-ttu-id="897e5-213">[![Pagina degli stati dei file di ER per le origini selezionate](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="897e5-213">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="897e5-214">Importa dati da file SharePoint</span><span class="sxs-lookup"><span data-stu-id="897e5-214">Import data from SharePoint files</span></span>
1. <span data-ttu-id="897e5-215">Aprire la struttura delle configurazioni di ER, selezionare **1099 Modello pagamenti** ed espandere l'elenco di componenti del modello di ER.</span><span class="sxs-lookup"><span data-stu-id="897e5-215">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="897e5-216">Selezionare il nome del mapping di modello per aprire l'elenco di mapping di modello della configurazione del modello di ER selezionata.</span><span class="sxs-lookup"><span data-stu-id="897e5-216">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

    <span data-ttu-id="897e5-217">[![Pagina degli stati dei file di ER per le origini selezionate](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-217">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="897e5-218">Selezionare **Esegui** per eseguire il mapping di modello selezionato.</span><span class="sxs-lookup"><span data-stu-id="897e5-218">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="897e5-219">Poiché sono state configurate origini di file per il formato di ER, è possibile modificare l'impostazione dell'opzione **Origine file** se necessario.</span><span class="sxs-lookup"><span data-stu-id="897e5-219">Because you configured file sources for the ER format, you can change the setting of the **File source** option, if needed.</span></span> <span data-ttu-id="897e5-220">Se si mantiene l'impostazione di questa opzione, i file con estensione xslx vengono importati dalle origini configurate (le cartelle di SharePoint, in questo esempio).</span><span class="sxs-lookup"><span data-stu-id="897e5-220">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="897e5-221">In questo esempio, si importa un solo file.</span><span class="sxs-lookup"><span data-stu-id="897e5-221">In this example, you're importing only one file.</span></span> <span data-ttu-id="897e5-222">Se tuttavia sono presenti più file questi vengono selezionati per l'importazione nell'ordine in cui sono stati aggiunti nella cartella di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="897e5-222">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="897e5-223">Ogni esecuzione di un formato di ER importa un singolo file selezionato.</span><span class="sxs-lookup"><span data-stu-id="897e5-223">Every run of an ER format imports a single selected file.</span></span>

    <span data-ttu-id="897e5-224">[![Eseguire il mapping di modello di ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-224">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="897e5-225">Il mapping di modello può essere eseguito automaticamente nella modalità batch.</span><span class="sxs-lookup"><span data-stu-id="897e5-225">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="897e5-226">In questo caso, ogni volta che si esegue un batch in questo formato di ER, viene importato un singolo file dalle origini di file configurate.</span><span class="sxs-lookup"><span data-stu-id="897e5-226">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span>

    <span data-ttu-id="897e5-227">Quando un file viene importato correttamente dalla cartella di SharePoint, viene eliminato da quella cartella e spostato nella cartella dei file importati correttamente o nella cartella dei file importati con avvisi.</span><span class="sxs-lookup"><span data-stu-id="897e5-227">When a file is successfully imported from the SharePoint folder, it's deleted from that folder and moved to folder for successful imported files or to the folder to imported files with warnings.</span></span> <span data-ttu-id="897e5-228">In caso contrario, viene spostato nella cartella dei file la cui importazione non è riuscita a meno che tale cartella non sia stata creata.</span><span class="sxs-lookup"><span data-stu-id="897e5-228">Otherwise it's moved to folder for failed files or stays in this folder if the folder for failed files isn't set up.</span></span> 

5. <span data-ttu-id="897e5-229">Immettere l'ID giustificativo, ad esempio **V-00001**, quindi selezionare **OK**.</span><span class="sxs-lookup"><span data-stu-id="897e5-229">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

    <span data-ttu-id="897e5-230">[![Eseguire il mapping di modello di ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-230">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="897e5-231">Nella pagina **Stati dei file per le origini** selezionare **Aggiorna** per aggiornare la pagina.</span><span class="sxs-lookup"><span data-stu-id="897e5-231">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

    <span data-ttu-id="897e5-232">[![Pagina degli stati dei file di ER per le origini selezionate](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-232">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="897e5-233">Nella sezione **File** esaminare l'elenco dei file.</span><span class="sxs-lookup"><span data-stu-id="897e5-233">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="897e5-234">Nella sezione **Registri delle origini per il formato di importazione** è presente la cronologia dell'importazione del file di Excel.</span><span class="sxs-lookup"><span data-stu-id="897e5-234">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="897e5-235">Poiché questo file è stato importato correttamente, nella cartella di SharePoint viene contrassegnato come **Eliminato**.</span><span class="sxs-lookup"><span data-stu-id="897e5-235">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="897e5-236">Esaminare la cartella di SharePoint **Origine di importazione dei file (principale)**.</span><span class="sxs-lookup"><span data-stu-id="897e5-236">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="897e5-237">I file di Excel importati correttamente sono stati eliminati da questa cartella.</span><span class="sxs-lookup"><span data-stu-id="897e5-237">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="897e5-238">In Finance and Operations, selezionare **Contabilità fornitori** \> **Attività periodiche** \> **Imposta 1099** \> **Liquidazione fornitore per i moduli 1099**.</span><span class="sxs-lookup"><span data-stu-id="897e5-238">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="897e5-239">Nei campi **Dal** e **Al** immettere i valori appropriati.</span><span class="sxs-lookup"><span data-stu-id="897e5-239">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="897e5-240">Selezionare quindi **Transazioni 1099 manuali**.</span><span class="sxs-lookup"><span data-stu-id="897e5-240">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="897e5-241">Le transazioni fornitori che sono state importate dai file di Excel in SharePoint per il giustificativo **V-00001** vengono visualizzate nella pagina.</span><span class="sxs-lookup"><span data-stu-id="897e5-241">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

    <span data-ttu-id="897e5-242">[![Pagina Transazioni 1099 fornitore](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-242">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="897e5-243">Preparare un file di Excel per l'importazione</span><span class="sxs-lookup"><span data-stu-id="897e5-243">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="897e5-244">Aprire il file di Excel utilizzato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="897e5-244">Open the Excel file that you previously used.</span></span> <span data-ttu-id="897e5-245">Nella riga 3 della colonna 1, aggiungere un codice fornitore che non esiste nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="897e5-245">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="897e5-246">Aggiungere nella riga altre informazioni sul fornitore false.</span><span class="sxs-lookup"><span data-stu-id="897e5-246">Add additional false vendor information to the row.</span></span>

    <span data-ttu-id="897e5-247">[![Esempio di file di Microsoft Excel per l'importazione da SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-247">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="897e5-248">Caricare il file di Excel aggiornato contenente le transazioni fornitori nella cartella di SharePoint **Origine di importazione dei file (principale)**.</span><span class="sxs-lookup"><span data-stu-id="897e5-248">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="897e5-249">In Finance and Operations, aprire la struttura delle configurazioni di ER, selezionare **1099 Modello pagamenti** ed espandere l'elenco di componenti del modello di ER.</span><span class="sxs-lookup"><span data-stu-id="897e5-249">In Finance and Operations, open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="897e5-250">Selezionare il nome del mapping di modello per aggiornare il mapping di modello in modo da considerare il codice fornitore errato come un errore durante il processo di importazione di dati.</span><span class="sxs-lookup"><span data-stu-id="897e5-250">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="897e5-251">Selezionare **Designer**.</span><span class="sxs-lookup"><span data-stu-id="897e5-251">Select **Designer**.</span></span>
6. <span data-ttu-id="897e5-252">Nella scheda **Convalide**, è necessario modificare l'azione post-convalida per la regola di convalida che è stata configurata per valutare se il conto fornitore importato esiste nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="897e5-252">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="897e5-253">Aggiornare il valore del campo **Azione post-convalida** impostandolo su **Arresta esecuzione**, salvare le modifiche e chiudere la pagina.</span><span class="sxs-lookup"><span data-stu-id="897e5-253">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

    <span data-ttu-id="897e5-254">[![Pagina Progettazione mapping modello di ER](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-254">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="897e5-255">Salvare le modifiche e chiudere la finestra Progettazione mapping di modello di ER.</span><span class="sxs-lookup"><span data-stu-id="897e5-255">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="897e5-256">Selezionare **Esegui** per eseguire il mapping di modello di ER modificato.</span><span class="sxs-lookup"><span data-stu-id="897e5-256">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="897e5-257">Immettere l'ID giustificativo, ad esempio **V-00002**, quindi selezionare **OK**.</span><span class="sxs-lookup"><span data-stu-id="897e5-257">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="897e5-258">Il Registro informazioni contiene una notifica che informa della presenza di un file nella cartella di SharePoint contenente un conto fornitore errato e che quindi non può essere importato.</span><span class="sxs-lookup"><span data-stu-id="897e5-258">Note that the Infolog contains a notification that there's a file in the SharePoint folder that contains incorrect vendor account and can’t be imported.</span></span>

    <span data-ttu-id="897e5-259">[![Eseguire il mapping di modello di ER](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-259">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="897e5-260">Nella pagina **Stati dei file per le origini**, selezionare **Aggiorna**, quindi nella sezione **File** esaminare l'elenco dei file.</span><span class="sxs-lookup"><span data-stu-id="897e5-260">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

    <span data-ttu-id="897e5-261">[![Pagina degli stati dei file di ER per le origini selezionate](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="897e5-261">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

   <span data-ttu-id="897e5-262">La sezione **Registri delle origini per il formato di importazione** indica che il processo di importazione non è riuscito e che il file si trova nella cartella di errori dei file di SharePoint (la casella di controllo **Eliminato** non è selezionata).</span><span class="sxs-lookup"><span data-stu-id="897e5-262">The **Sources log for the import format** section indicates that the import process failed and that the file is in the Files error SharePoint folder (the **Is deleted** check box is not selected).</span></span> <span data-ttu-id="897e5-263">Se si corregge questo file in SharePoint aggiungendo il codice fornitore appropriato è poi lo si sposta nella cartella Origine di importazione dei file (principale) di SharePoint, è possibile importare il file nuovamente.</span><span class="sxs-lookup"><span data-stu-id="897e5-263">If you fix this file on SharePoint by adding the proper vendor code and then move it to the Files import source (main) SharePoint folder, you can import the file again.</span></span>

11. <span data-ttu-id="897e5-264">In Finance and Operations, selezionare **Contabilità fornitori** \> **Attività periodiche** \> **Imposta 1099** \> **Liquidazione fornitore per i moduli 1099**, immettere i valori appropriati nei campi **Dal** e **Al** e quindi selezionare **Transazioni 1099 manuali**.</span><span class="sxs-lookup"><span data-stu-id="897e5-264">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="897e5-265">Solo le transazioni per il giustificativo V-00001 sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="897e5-265">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="897e5-266">Non sono presenti transazioni per il giustificativo V-00002 anche se l'errore dell'ultima transazione importata viene trovato nel file di Excel.</span><span class="sxs-lookup"><span data-stu-id="897e5-266">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>
