---
title: Configurare l'importazione di dati da SharePoint
description: In questo argomento viene descritto come importare i dati da Microsoft SharePoint.
author: NickSelin
manager: AnnBe
ms.date: 05/21/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.translationtype: HT
ms.sourcegitcommit: 2fc887668171175d436b9eb281a35c1c9d089591
ms.openlocfilehash: 4285db9c71208bce45d64933e692a25ef3f46b26
ms.contentlocale: it-it
ms.lasthandoff: 08/09/2018

---
# <a name="configure-data-import-from-sharepoint"></a><span data-ttu-id="854f3-103">Configurare l'importazione di dati da SharePoint</span><span class="sxs-lookup"><span data-stu-id="854f3-103">Configure data import from SharePoint</span></span>

[!include[banner](../includes/banner.md)]

<span data-ttu-id="854f3-104">Per importare dati da un file ricevuto utilizzando il framework di creazione di report elettronici (ER, electronic reporting), è necessario configurare un formato di ER che supporti l'importazione e quindi eseguire il mapping di modello del tipo **A destinazione** che utilizza quel formato come origine dati.</span><span class="sxs-lookup"><span data-stu-id="854f3-104">To import data from an incoming file by using the Electronic reporting (ER) framework, you must configure an ER format that supports the import and then run a model mapping of the **To destination** type that uses that format as a data source.</span></span> <span data-ttu-id="854f3-105">Per importare i dati, è necessario passare al file da importare.</span><span class="sxs-lookup"><span data-stu-id="854f3-105">To import data, you must navigate to the file that you want to import.</span></span> <span data-ttu-id="854f3-106">Il file ricevuto può essere selezionato manualmente dall'utente.</span><span class="sxs-lookup"><span data-stu-id="854f3-106">The incoming file can be manually selected by user.</span></span> <span data-ttu-id="854f3-107">Con la nuova funzionalità di ER per supportare l'importazione dei dati da Microsoft SharePoint, questo processo può essere configurato come quello automatico.</span><span class="sxs-lookup"><span data-stu-id="854f3-107">With the new ER capability to support importing data from Microsoft SharePoint, this process can be configured as the unattended one.</span></span> <span data-ttu-id="854f3-108">È possibile utilizzare le configurazioni di ER per eseguire l'importazione di dati dai file che sono archiviati in cartelle di Microsoft SharePoint.</span><span class="sxs-lookup"><span data-stu-id="854f3-108">You can use ER configurations to perform data import from files that are stored in Microsoft SharePoint folders.</span></span> <span data-ttu-id="854f3-109">In questo argomento viene descritto come completare l'importazione da SharePoint in Microsoft Dynamics 365 for Finance and Operations.</span><span class="sxs-lookup"><span data-stu-id="854f3-109">This topic explains how to complete the import from SharePoint to Microsoft Dynamics 365 for Finance and Operations.</span></span> <span data-ttu-id="854f3-110">Gli esempi utilizzano transazioni fornitore come dati aziendali.</span><span class="sxs-lookup"><span data-stu-id="854f3-110">The examples use vendor transactions as business data.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="854f3-111">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="854f3-111">Prerequisites</span></span>
<span data-ttu-id="854f3-112">Per completare gli esempi in questo argomento, è necessario disporre del seguente accesso:</span><span class="sxs-lookup"><span data-stu-id="854f3-112">To complete the examples in this topic, you must have the following access:</span></span>

- <span data-ttu-id="854f3-113">Accesso a Finance and Operations per uno dei seguenti ruoli:</span><span class="sxs-lookup"><span data-stu-id="854f3-113">Access to Finance and Operations for one of the following roles:</span></span>

    - <span data-ttu-id="854f3-114">Sviluppatore per la creazione di report elettronici</span><span class="sxs-lookup"><span data-stu-id="854f3-114">Electronic reporting developer</span></span>
    - <span data-ttu-id="854f3-115">Consulente funzionale per la creazione di report elettronici</span><span class="sxs-lookup"><span data-stu-id="854f3-115">Electronic reporting functional consultant</span></span>
    - <span data-ttu-id="854f3-116">Amministratore di sistema</span><span class="sxs-lookup"><span data-stu-id="854f3-116">System administrator</span></span>

- <span data-ttu-id="854f3-117">Accesso all'istanza di Microsoft SharePoint Server configurato per l'utilizzo con Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="854f3-117">Access to the instance of Microsoft SharePoint Server that is configured for use with Finance and Operations</span></span>
- <span data-ttu-id="854f3-118">Configurazioni di formato ER e di modello per 1099 pagamenti</span><span class="sxs-lookup"><span data-stu-id="854f3-118">ER format and model configurations for 1099 payments</span></span>

### <a name="create-required-er-configurations"></a><span data-ttu-id="854f3-119">Creare le configurazioni di ER richieste</span><span class="sxs-lookup"><span data-stu-id="854f3-119">Create required ER configurations</span></span>
<span data-ttu-id="854f3-120">Riprodurre le guide attività  **ER Importare i data da un file di Microsoft Excel**, che fanno parte del processo aziendale **7.5.4.3 Acquisire/sviluppare componenti di soluzioni/servizi IT (10677)**.</span><span class="sxs-lookup"><span data-stu-id="854f3-120">Play the **ER Import data from a Microsoft Excel file** task guides, which are part of the **7.5.4.3 Acquire/Develop IT service/solution components (10677)** business process.</span></span> <span data-ttu-id="854f3-121">Queste guide attività illustrano in dettaglio il processo di progettazione e di utilizzo delle configurazioni ER per importare in modo interattivo transazioni fornitori da file di Microsoft Excel esterni.</span><span class="sxs-lookup"><span data-stu-id="854f3-121">These task guides walk you through the process of designing and using ER configurations to interactively import vendor transactions from external Microsoft Excel files.</span></span> <span data-ttu-id="854f3-122">Per ulteriori informazioni, vedere [Analizzare i documenti ricevuti in Microsoft Excel](parse-incoming-documents-excel.md).</span><span class="sxs-lookup"><span data-stu-id="854f3-122">For more information, see [Parse incoming documents in Microsoft Excel](parse-incoming-documents-excel.md).</span></span> <span data-ttu-id="854f3-123">Alla fine si avranno a disposizione:</span><span class="sxs-lookup"><span data-stu-id="854f3-123">Fianlly, you will have:</span></span>

- <span data-ttu-id="854f3-124">Configurazioni ER:</span><span class="sxs-lookup"><span data-stu-id="854f3-124">ER configurations:</span></span>

    - <span data-ttu-id="854f3-125">Configurazione del modello di ER, **1099 Modello pagamenti**</span><span class="sxs-lookup"><span data-stu-id="854f3-125">ER model configuration, **1099 Payments model**</span></span>
    - <span data-ttu-id="854f3-126">Configurazione del formato per ER, **Formato per importare transazioni fornitori da Excel**</span><span class="sxs-lookup"><span data-stu-id="854f3-126">ER format configuration, **Format for importing vendors' transactions from Excel**</span></span>

<span data-ttu-id="854f3-127">[![Configurazioni di ER per importare i dati da SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-127">[![ER configurations for importing data from SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)](./media/GERImportFromSharePoint-01-Configurations.PNG)</span></span>

- <span data-ttu-id="854f3-128">Esempio di file ricevuto per l'importazione dei dati:</span><span class="sxs-lookup"><span data-stu-id="854f3-128">Sample of the incoming file for data import:</span></span>

    - <span data-ttu-id="854f3-129">File di Excel **1099import-data.xlsx**, con transazioni fornitori che devono essere importate in Finance and Operations</span><span class="sxs-lookup"><span data-stu-id="854f3-129">Excel file **1099import-data.xlsx**, with vendor transactions that should be imported into Finance and Operations</span></span>

<span data-ttu-id="854f3-130">[![Esempio di file di Microsoft Excel per l'importazione da SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-130">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)](./media/GERImportFromSharePoint-02-Excel.PNG)</span></span>

> [!NOTE]
> <span data-ttu-id="854f3-131">Il formato per l'importazione delle transazioni fornitori è selezionato come mapping di modello predefinito.</span><span class="sxs-lookup"><span data-stu-id="854f3-131">The format for importing vendor transactions is selected as the default model mapping.</span></span> <span data-ttu-id="854f3-132">Se quindi si esegue un mapping di modello del **1099 modello pagamenti** e quel mapping di modello è di tipo **A destinazione**, il mapping di modello esegue questo formato per importare i dati da file esterni.</span><span class="sxs-lookup"><span data-stu-id="854f3-132">Therefore, if you run a model mapping of the **1099 Payments model**, and that model mapping is of the **To destination** type, the model mapping runs this format to import data from external files.</span></span> <span data-ttu-id="854f3-133">Utilizza quindi i dati per aggiornare le tabelle dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="854f3-133">It then uses that data to update application tables.</span></span>

## <a name="configure-document-management-parameters"></a><span data-ttu-id="854f3-134">Configurare i parametri di gestione documenti</span><span class="sxs-lookup"><span data-stu-id="854f3-134">Configure Document management parameters</span></span>
1. <span data-ttu-id="854f3-135">Nella pagina **Parametri di gestione documenti** configurare l'accesso all'istanza di SharePoint Server che verrà utilizzato dalla società a cui è stato eseguito l'accesso.</span><span class="sxs-lookup"><span data-stu-id="854f3-135">On the **Document management parameters** page, configure access to the SharePoint Server instance that will be used by the company that you're currently signed in to.</span></span> <span data-ttu-id="854f3-136">In questo esempio, la società è USMF.</span><span class="sxs-lookup"><span data-stu-id="854f3-136">In this example, the company is USMF.</span></span>
2. <span data-ttu-id="854f3-137">Verificare la connessione all'istanza di SharePoint Server per assicurarsi di disporre dell'accesso.</span><span class="sxs-lookup"><span data-stu-id="854f3-137">Test the connection to the SharePoint Server instance to make sure that you've been granted access.</span></span>

<span data-ttu-id="854f3-138">[![Impostazione gestione documenti - server SharePoint](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span><span class="sxs-lookup"><span data-stu-id="854f3-138">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-03-SharePointSetup.png)](./media/GERImportFromSharePoint-03-SharePointSetup.png)</span></span>

3. <span data-ttu-id="854f3-139">Aprire il sito di SharePoint configurato e creare le seguenti cartelle in cui verranno memorizzati i file ricevuti:</span><span class="sxs-lookup"><span data-stu-id="854f3-139">Open the configured SharePoint site, and create the following folders where the incoming files can be stored:</span></span>

    - <span data-ttu-id="854f3-140">Origine di importazione dei file (principale)</span><span class="sxs-lookup"><span data-stu-id="854f3-140">Files import source (main)</span></span>
    - <span data-ttu-id="854f3-141">Origine di importazione dei file (alternativa)</span><span class="sxs-lookup"><span data-stu-id="854f3-141">Files import source (alternative)</span></span>

<span data-ttu-id="854f3-142">[![Impostazione gestione documenti - server SharePoint](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span><span class="sxs-lookup"><span data-stu-id="854f3-142">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-04-SharePointFolder1.png)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)</span></span>

<span data-ttu-id="854f3-143">[![Impostazione gestione documenti - server SharePoint](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span><span class="sxs-lookup"><span data-stu-id="854f3-143">[![Document management setting – SharePoint server](./media/GERImportFromSharePoint-05-SharePointFolder2.png)](./media/GERImportFromSharePoint-05-SharePointFolder2.png)</span></span>

4. <span data-ttu-id="854f3-144">In Finance and Operations, nella pagina **Tipi di documento**, creare i seguenti tipi di documento che verranno utilizzati per accedere alle cartelle di SharePoint appena create:</span><span class="sxs-lookup"><span data-stu-id="854f3-144">In Finance and Operations, on the **Document types** page, create the following document types that will be used to access the SharePoint folders that you just created:</span></span>

    - <span data-ttu-id="854f3-145">Principale di SP</span><span class="sxs-lookup"><span data-stu-id="854f3-145">SP Main</span></span>
    - <span data-ttu-id="854f3-146">Alternativa di SP</span><span class="sxs-lookup"><span data-stu-id="854f3-146">SP Alternative</span></span>

5. <span data-ttu-id="854f3-147">Per i tipi di documento creati, nel campo **Gruppo**, immettere **File** e nel campo **Posizione** immettere **SharePoint**.</span><span class="sxs-lookup"><span data-stu-id="854f3-147">For created document types, in the **Group** field, enter **File** and in the **Location** field, enter **SharePoint**.</span></span> <span data-ttu-id="854f3-148">Immettere quindi l'indirizzo della cartella SharePoint:</span><span class="sxs-lookup"><span data-stu-id="854f3-148">Then enter the address of the SharePoint folder:</span></span>

    - <span data-ttu-id="854f3-149">Per il tipo di documento **Principale di SP**: origine di importazione dei file (principale)</span><span class="sxs-lookup"><span data-stu-id="854f3-149">For the **SP Main** document type: Files import source (main)</span></span>
    - <span data-ttu-id="854f3-150">Per il tipo di documento **Alternativa di SP**: origine di importazione dei file (alternativa)</span><span class="sxs-lookup"><span data-stu-id="854f3-150">For the **SP Alternative** document type: Files import source (alternative)</span></span>

<span data-ttu-id="854f3-151">[![Impostazione di SharePoint - nuovo tipo di documento](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span><span class="sxs-lookup"><span data-stu-id="854f3-151">[![SharePoint setting – new document type](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)</span></span>

## <a name="configure-er-sources-for-the-er-format"></a><span data-ttu-id="854f3-152">Configurare le origini di ER per il formato di ER</span><span class="sxs-lookup"><span data-stu-id="854f3-152">Configure ER sources for the ER format</span></span>
1. <span data-ttu-id="854f3-153">Fare clic su **Amministrazione organizzazione** > **Creazione di report elettronici** > **Origine creazione di report elettronici**.</span><span class="sxs-lookup"><span data-stu-id="854f3-153">Click **Organization administration** > **Electronic reporting** > **Electronic reporting source**.</span></span>
2. <span data-ttu-id="854f3-154">Nella pagina **Origine creazione di report elettronici** configurare i file di origine per l'importazione dei dati utilizzando il formato di ER configurato.</span><span class="sxs-lookup"><span data-stu-id="854f3-154">On the **Electronic reporting source** page, configure the source files for data import by using the configured ER format.</span></span>
3. <span data-ttu-id="854f3-155">Definire una maschera del nome di file, in modo che solo i file con estensione xlsx vengano importati.</span><span class="sxs-lookup"><span data-stu-id="854f3-155">Define a file name mask, so that only files with the .xlsx extension are imported.</span></span> <span data-ttu-id="854f3-156">La maschera del nome di file è facoltativa e viene utilizzata solo quando è stata definita.</span><span class="sxs-lookup"><span data-stu-id="854f3-156">The file name mask is optional and is used only when it has been defined.</span></span> <span data-ttu-id="854f3-157">È possibile definire una sola maschera per ogni formato di ER.</span><span class="sxs-lookup"><span data-stu-id="854f3-157">You can define only one mask for each ER format.</span></span>
4. <span data-ttu-id="854f3-158">Selezionare entrambe le cartelle di SharePoint create in precedenza.</span><span class="sxs-lookup"><span data-stu-id="854f3-158">Select both SharePoint folders that you created earlier.</span></span>

<span data-ttu-id="854f3-159">[![Impostazione dell'origine dei file di ER](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-159">[![ER files source setting](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)</span></span>

> [!NOTE]
><span data-ttu-id="854f3-160">L'*origine* di ER viene definita per ogni società dell'applicazione individualmente.</span><span class="sxs-lookup"><span data-stu-id="854f3-160">The ER *source* is defined for each application company individually.</span></span> <span data-ttu-id="854f3-161">Le *configurazioni* di ER vengono invece condivise tra le società.</span><span class="sxs-lookup"><span data-stu-id="854f3-161">By contrast, ER *configurations* are shared across companies.</span></span>

> [!NOTE]
> <span data-ttu-id="854f3-162">Quando si elimina un'impostazione di origine di ER per un formato di ER, vengono eliminati anche tutti gli stati dei file connessi (vedere sotto).</span><span class="sxs-lookup"><span data-stu-id="854f3-162">When you delete an ER source setting for an ER format, all connected file states (see below) are also deleted.</span></span>

## <a name="review-the-files-states-for-the-er-format"></a><span data-ttu-id="854f3-163">Esaminare gli stati dei file per il formato di ER</span><span class="sxs-lookup"><span data-stu-id="854f3-163">Review the files states for the ER format</span></span>
1. <span data-ttu-id="854f3-164">Nella pagina **Origine creazione di report elettronici** selezionare **Stati dei file per le origini** per esaminare il contenuto delle origini dei file configurate per il formato di ER corrente.</span><span class="sxs-lookup"><span data-stu-id="854f3-164">On the **Electronic reporting source** page, select **File states for the sources** to review the content of the configured file sources for the current ER format.</span></span>
2. <span data-ttu-id="854f3-165">Nella sezione **File** esaminare l'elenco dei file.</span><span class="sxs-lookup"><span data-stu-id="854f3-165">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="854f3-166">Questo elenco presenta gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="854f3-166">This list presents the following:</span></span>

    - <span data-ttu-id="854f3-167">File di origine applicabili, in base alla maschera del nome di file (se viene definita una maschera del nome di file), e pronti per l'importazione di dati.</span><span class="sxs-lookup"><span data-stu-id="854f3-167">Source files that are applicable, based on the file name mask (if a file name mask is defined), and that are ready for data import.</span></span> <span data-ttu-id="854f3-168">Per tali file, la sezione **Registri delle origini per il formato di importazione** è vuota.</span><span class="sxs-lookup"><span data-stu-id="854f3-168">For these files, the **Sources log for the import format** section is blank.</span></span>
    - <span data-ttu-id="854f3-169">File precedentemente importati.</span><span class="sxs-lookup"><span data-stu-id="854f3-169">Previously imported files.</span></span> <span data-ttu-id="854f3-170">Per ognuno di questi file, nella sezione **Registri delle origini per il formato di importazione** è possibile esaminare la cronologia di importazione del file.</span><span class="sxs-lookup"><span data-stu-id="854f3-170">For each of these files, in the **Sources log for the import format** section, you can review the history of import of this file.</span></span>

<span data-ttu-id="854f3-171">È inoltre possibile aprire la pagina **Stati dei file per le origini** selezionando **Amministrazione organizzazione** \> **Creazione di report elettronici** \> **Stati dei file per le origini**.</span><span class="sxs-lookup"><span data-stu-id="854f3-171">You can also open the **File states for the sources** page by selecting **Organization administration** \> **Electronic reporting** \> **File states for the sources**.</span></span> <span data-ttu-id="854f3-172">In questo caso, la pagina fornisce informazioni sulle origini dei file per tutti i formati di ER per cui sono state configurate le origini dei file nella società a cui si è attualmente connessi.</span><span class="sxs-lookup"><span data-stu-id="854f3-172">In this case, the page provides information about file sources for all ER formats that file sources have been configured for in the company that you're currently signed in to.</span></span>

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a><span data-ttu-id="854f3-173">Importare dati da file di Excel in una cartella di SharePoint</span><span class="sxs-lookup"><span data-stu-id="854f3-173">Import data from Excel files that are in a SharePoint folder</span></span>
1. <span data-ttu-id="854f3-174">In SharePoint, caricare il file di Microsoft Excel denominato **1099import-data.xlsx**, contenente le transazioni fornitori, nella cartella di SharePoint **Origine di importazione dei file (principale)** creata in precedenza.</span><span class="sxs-lookup"><span data-stu-id="854f3-174">In SharePoint, upload the Microsoft Excel file **1099import-data.xlsx** that contains vendor transactions to the **Files import source (main)** SharePoint folder that you created earlier.</span></span>

<span data-ttu-id="854f3-175">[![Contenuto di SharePoint - file di Microsoft Excel per l'importazione](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span><span class="sxs-lookup"><span data-stu-id="854f3-175">[![SharePoint content – Microsoft Excel file for importing](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)</span></span>

2. <span data-ttu-id="854f3-176">In Finance and Operations, nella pagina **Stati dei file per le origini** selezionare **Aggiorna** per aggiornare la pagina.</span><span class="sxs-lookup"><span data-stu-id="854f3-176">In Finance and Operations, on the **File states for the sources** page, select **Refresh** to refresh the page.</span></span> <span data-ttu-id="854f3-177">Si noti che il file di Excel che è stato caricato in SharePoint viene visualizzato in questo modulo con lo stato **Pronto**.</span><span class="sxs-lookup"><span data-stu-id="854f3-177">Note that the Excel file that was uploaded to SharePoint appeared in this form with the status **Ready**.</span></span> <span data-ttu-id="854f3-178">Al momento sono disponibili i seguenti stati:</span><span class="sxs-lookup"><span data-stu-id="854f3-178">The following statuses are currently supported:</span></span>

    - <span data-ttu-id="854f3-179">**Pronto** - Assegnato automaticamente per ogni nuovo file in una cartella di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="854f3-179">**Ready** - Assigned automatically for each new file in a SharePoint folder.</span></span> <span data-ttu-id="854f3-180">Questo stato indica che il file è pronto per l'importazione.</span><span class="sxs-lookup"><span data-stu-id="854f3-180">This status means that the file is ready for import.</span></span>
    - <span data-ttu-id="854f3-181">**Importazione** - Assegnato automaticamente da un report di ER quando il file viene bloccato dal processo di importazione per impedirne l'utilizzo da parte di altri processi (nel caso in cui vengano eseguiti più processi contemporaneamente).</span><span class="sxs-lookup"><span data-stu-id="854f3-181">**Importing** - Assigned automatically by an ER report when the file will be locked by the import process to prevent its usage by other processes (if many of them are running simultaneously).</span></span>
    - <span data-ttu-id="854f3-182">**Importato** - Assegnato automaticamente da un report di ER al termine della corretta importazione di file.</span><span class="sxs-lookup"><span data-stu-id="854f3-182">**Imported** - Assigned automatically by an ER report when the file import is successfully completed.</span></span> <span data-ttu-id="854f3-183">Questo stato indica che il file importato è stato eliminato dall'origine di file configurata (cartella di SharePoint).</span><span class="sxs-lookup"><span data-stu-id="854f3-183">This status means that the imported file has been deleted from the configured files source (SharePoint folder).</span></span>
    - <span data-ttu-id="854f3-184">**Non riuscito** - Assegnato automaticamente da un report di ER quando l'importazione dei file genera errori o eccezioni.</span><span class="sxs-lookup"><span data-stu-id="854f3-184">**Failed** - Assigned automatically by an ER report when the file import completed with errors or exceptions.</span></span>
    - <span data-ttu-id="854f3-185">**In attesa** - Assegnato manualmente dall'utente in questo modulo.</span><span class="sxs-lookup"><span data-stu-id="854f3-185">**On hold** - Assigned manually by user on this form.</span></span> <span data-ttu-id="854f3-186">Questo stato indica che il file non verrà importato per il momento.</span><span class="sxs-lookup"><span data-stu-id="854f3-186">This status means that the file will not be imported for now.</span></span> <span data-ttu-id="854f3-187">Questo stato può essere utilizzato per posticipare l'importazione di alcuni file.</span><span class="sxs-lookup"><span data-stu-id="854f3-187">This status can be used to postpone the import of some files.</span></span>

<span data-ttu-id="854f3-188">[![Pagina degli stati dei file di ER per le origini selezionate](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span><span class="sxs-lookup"><span data-stu-id="854f3-188">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)</span></span>

## <a name="import-data-from-sharepoint-files"></a><span data-ttu-id="854f3-189">Importare i dati da file di SharePoint</span><span class="sxs-lookup"><span data-stu-id="854f3-189">Import data from SharePoint files</span></span>
1. <span data-ttu-id="854f3-190">Aprire la struttura delle configurazioni di ER, selezionare **1099 Modello pagamenti** ed espandere l'elenco di componenti del modello di ER.</span><span class="sxs-lookup"><span data-stu-id="854f3-190">Open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
2. <span data-ttu-id="854f3-191">Selezionare il nome del mapping di modello per aprire l'elenco di mapping di modello della configurazione del modello di ER selezionata.</span><span class="sxs-lookup"><span data-stu-id="854f3-191">Select the name of the model mapping to open the list of model mappings of the selected ER model configuration.</span></span>

<span data-ttu-id="854f3-192">[![Pagina degli stati dei file di ER per le origini selezionate](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-192">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)</span></span>

3. <span data-ttu-id="854f3-193">Selezionare **Esegui** per eseguire il mapping di modello selezionato.</span><span class="sxs-lookup"><span data-stu-id="854f3-193">Select **Run** to run the selected model mapping.</span></span> <span data-ttu-id="854f3-194">Poiché sono state configurate origini di file per il formato di ER, è possibile modificare l'impostazione dell'opzione **Origine file** in base alle proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="854f3-194">Because you configured file sources for the ER format, you can change the setting of the **File source** option as you require.</span></span> <span data-ttu-id="854f3-195">Se si mantiene l'impostazione di questa opzione, i file con estensione xslx vengono importati dalle origini configurate (le cartelle di SharePoint, in questo esempio).</span><span class="sxs-lookup"><span data-stu-id="854f3-195">If you keep the setting of this option, the .xslx files are imported from the configured sources (the SharePoint folders, in this example).</span></span>

    <span data-ttu-id="854f3-196">In questo esempio, si importa un solo file.</span><span class="sxs-lookup"><span data-stu-id="854f3-196">In this example, you're importing only one file.</span></span> <span data-ttu-id="854f3-197">Se tuttavia sono presenti più file questi vengono selezionati per l'importazione nell'ordine in cui sono stati aggiunti nella cartella di SharePoint.</span><span class="sxs-lookup"><span data-stu-id="854f3-197">However, if there are multiple files, they are selected for importing in the order in which they were added to the SharePoint folder.</span></span> <span data-ttu-id="854f3-198">Ogni esecuzione di un formato di ER importa un singolo file selezionato.</span><span class="sxs-lookup"><span data-stu-id="854f3-198">Every run of an ER format imports a single selected file.</span></span>

<span data-ttu-id="854f3-199">[![Eseguire il mapping di modello di ER](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-199">[![Run ER model mapping](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)</span></span>

4. <span data-ttu-id="854f3-200">Il mapping di modello può essere eseguito automaticamente nella modalità batch.</span><span class="sxs-lookup"><span data-stu-id="854f3-200">The model mapping can run unattended in batch mode.</span></span> <span data-ttu-id="854f3-201">In questo caso, ogni volta che si esegue un batch in questo formato di ER, viene importato un singolo file dalle origini di file configurate.</span><span class="sxs-lookup"><span data-stu-id="854f3-201">In this case, every time that a batch runs this ER format, a single file is imported from the configured file sources.</span></span> <span data-ttu-id="854f3-202">Utilizzare il codice seguente per implementare l'esecuzione batch.</span><span class="sxs-lookup"><span data-stu-id="854f3-202">Use the following code to implement this batch run.</span></span>

    ```
    ERObjectsFactory::createMappingDestinationRunByImportFormatMappingId().run()
    ```

    <span data-ttu-id="854f3-203">Quando un file viene importato correttamente dalla cartella di SharePoint, viene eliminato da tale cartella.</span><span class="sxs-lookup"><span data-stu-id="854f3-203">When a file is successfully imported from the SharePoint folder, it's deleted from that folder.</span></span>

5. <span data-ttu-id="854f3-204">Immettere l'ID giustificativo, ad esempio **V-00001**, quindi selezionare **OK**.</span><span class="sxs-lookup"><span data-stu-id="854f3-204">Enter the voucher ID, such as **V-00001**, and then select **OK**.</span></span>

<span data-ttu-id="854f3-205">[![Eseguire il mapping di modello di ER](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-205">[![Run ER model mapping](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)</span></span>

6. <span data-ttu-id="854f3-206">Nella pagina **Stati dei file per le origini** selezionare **Aggiorna** per aggiornare la pagina.</span><span class="sxs-lookup"><span data-stu-id="854f3-206">On the **File states for the sources** page, select **Refresh** to refresh the page.</span></span>

<span data-ttu-id="854f3-207">[![Pagina degli stati dei file di ER per le origini selezionate](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-207">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)</span></span>

7. <span data-ttu-id="854f3-208">Nella sezione **File** esaminare l'elenco dei file.</span><span class="sxs-lookup"><span data-stu-id="854f3-208">In the **Files** section, review the list of files.</span></span> <span data-ttu-id="854f3-209">Nella sezione **Registri delle origini per il formato di importazione** è presente la cronologia dell'importazione del file di Excel.</span><span class="sxs-lookup"><span data-stu-id="854f3-209">The **Sources log for the import format** section provides the history of the Excel file import.</span></span> <span data-ttu-id="854f3-210">Poiché questo file è stato importato correttamente, nella cartella di SharePoint viene contrassegnato come **Eliminato**.</span><span class="sxs-lookup"><span data-stu-id="854f3-210">Because this file was successfully imported, it's marked as **Deleted** in the SharePoint folder.</span></span>
8. <span data-ttu-id="854f3-211">Esaminare la cartella di SharePoint **Origine di importazione dei file (principale)**.</span><span class="sxs-lookup"><span data-stu-id="854f3-211">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="854f3-212">I file di Excel importati correttamente sono stati eliminati da questa cartella.</span><span class="sxs-lookup"><span data-stu-id="854f3-212">The Excel files that were successfully imported have been deleted from this folder.</span></span>
9. <span data-ttu-id="854f3-213">In Finance and Operations, selezionare **Contabilità fornitori** \> **Attività periodiche** \> **Imposta 1099** \> **Liquidazione fornitore per i moduli 1099**.</span><span class="sxs-lookup"><span data-stu-id="854f3-213">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**.</span></span>
10. <span data-ttu-id="854f3-214">Nei campi **Dal** e **Al** immettere i valori appropriati.</span><span class="sxs-lookup"><span data-stu-id="854f3-214">In the **From date** and **To date** fields, enter appropriate values.</span></span> <span data-ttu-id="854f3-215">Selezionare quindi **Transazioni 1099 manuali**.</span><span class="sxs-lookup"><span data-stu-id="854f3-215">Then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="854f3-216">Le transazioni fornitori che sono state importate dai file di Excel in SharePoint per il giustificativo **V-00001** vengono visualizzate nella pagina.</span><span class="sxs-lookup"><span data-stu-id="854f3-216">The vendor transactions that were imported from the Excel files on SharePoint for voucher **V-00001**, are presented on the page.</span></span>

<span data-ttu-id="854f3-217">[![Pagina Transazioni 1099 fornitore](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-217">[![1099 vendor transactions page](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)</span></span>

## <a name="prepare-an-excel-file-for-import"></a><span data-ttu-id="854f3-218">Preparare un file di Excel per l'importazione</span><span class="sxs-lookup"><span data-stu-id="854f3-218">Prepare an Excel file for import</span></span>
1. <span data-ttu-id="854f3-219">Aprire il file di Excel utilizzato in precedenza.</span><span class="sxs-lookup"><span data-stu-id="854f3-219">Open the Excel file that you previously used.</span></span> <span data-ttu-id="854f3-220">Nella riga 3 della colonna 1, aggiungere un codice fornitore che non esiste nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="854f3-220">In row 3 column 1, add a vendor code that doesn't exist in the application.</span></span> <span data-ttu-id="854f3-221">Aggiungere nella riga altre informazioni sul fornitore false.</span><span class="sxs-lookup"><span data-stu-id="854f3-221">Add additional false vendor information to the row.</span></span>

<span data-ttu-id="854f3-222">[![Esempio di file di Microsoft Excel per l'importazione da SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-222">[![Sample Microsoft Excel file for importing from SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)</span></span>

2. <span data-ttu-id="854f3-223">Caricare il file di Excel aggiornato contenente le transazioni fornitori nella cartella di SharePoint **Origine di importazione dei file (principale)**.</span><span class="sxs-lookup"><span data-stu-id="854f3-223">Upload the updated Excel file that contains vendors transactions to the **Files import source (main)** SharePoint folder.</span></span>
3. <span data-ttu-id="854f3-224">In Finance and Operations, aprire la struttura delle configurazioni di ER, selezionare **1099 Modello pagamenti** ed espandere l'elenco di componenti del modello di ER.</span><span class="sxs-lookup"><span data-stu-id="854f3-224">In Finance and Operations, open the ER configurations tree, select the **1099 Payment model**, and expand the list of ER model components.</span></span>
4. <span data-ttu-id="854f3-225">Selezionare il nome del mapping di modello per aggiornare il mapping di modello in modo da considerare il codice fornitore errato come un errore durante il processo di importazione di dati.</span><span class="sxs-lookup"><span data-stu-id="854f3-225">Select the name of the model mapping to update the model mapping so that the incorrect vendor code is considered an error during the data import process.</span></span>
5. <span data-ttu-id="854f3-226">Selezionare **Designer**.</span><span class="sxs-lookup"><span data-stu-id="854f3-226">Select **Designer**.</span></span>
6. <span data-ttu-id="854f3-227">Nella scheda **Convalide**, è necessario modificare l'azione post-convalida per la regola di convalida che è stata configurata per valutare se il conto fornitore importato esiste nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="854f3-227">On the **Validations** tab, you must change the post-validation action for the validation rule that was configured to evaluate whether the vendor account that is imported exists in the application.</span></span> <span data-ttu-id="854f3-228">Aggiornare il valore del campo **Azione post-convalida** impostandolo su **Arresta esecuzione**, salvare le modifiche e chiudere la pagina.</span><span class="sxs-lookup"><span data-stu-id="854f3-228">Update the value of the **Post-validation action** field to **Stop execution**, save your changes, and close the page.</span></span>

<span data-ttu-id="854f3-229">[![Pagina Progettazione mapping modello di ER](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-229">[![ER model mapping designer page](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)</span></span>

7. <span data-ttu-id="854f3-230">Salvare le modifiche e chiudere la finestra Progettazione mapping di modello di ER.</span><span class="sxs-lookup"><span data-stu-id="854f3-230">Save your changes, and close the ER model mapping designer.</span></span>
8. <span data-ttu-id="854f3-231">Selezionare **Esegui** per eseguire il mapping di modello di ER modificato.</span><span class="sxs-lookup"><span data-stu-id="854f3-231">Select **Run** to run the modified ER model mapping.</span></span>
9. <span data-ttu-id="854f3-232">Immettere l'ID giustificativo, ad esempio **V-00002**, quindi selezionare **OK**.</span><span class="sxs-lookup"><span data-stu-id="854f3-232">Enter the voucher ID, such as **V-00002**, and then select **OK**.</span></span>

    <span data-ttu-id="854f3-233">Il Registro informazioni contiene la notifica che informa che il file della cartella di SharePoint include il conto fornitore errato e non può essere importato.</span><span class="sxs-lookup"><span data-stu-id="854f3-233">Note that the Infolog contains the notification informing that residing in SharePoint folder file contains incorrect vendor account and can’t be imported.</span></span>

<span data-ttu-id="854f3-234">[![Eseguire il mapping di modello di ER](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-234">[![Run ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)</span></span>

10. <span data-ttu-id="854f3-235">Nella pagina **Stati dei file per le origini**, selezionare **Aggiorna**, quindi nella sezione **File** esaminare l'elenco dei file.</span><span class="sxs-lookup"><span data-stu-id="854f3-235">On the **File states for the sources** page, select **Refresh**, and then, in the **Files** section, review the list of files.</span></span>

<span data-ttu-id="854f3-236">[![Pagina degli stati dei file di ER per le origini selezionate](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span><span class="sxs-lookup"><span data-stu-id="854f3-236">[![ER file states page for the selected sources](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)</span></span>

<span data-ttu-id="854f3-237">La sezione **Registri delle origini per il formato di importazione** indica che il processo di importazione non è riuscito e che il file si trova ancora nella cartella di SharePoint (la casella di controllo **Eliminato** non è selezionata).</span><span class="sxs-lookup"><span data-stu-id="854f3-237">The **Sources log for the import format** section indicates that the import process failed and that the file is still in the SharePoint folder (the **Is deleted** checkbox is not selected).</span></span> <span data-ttu-id="854f3-238">Se si corregge questo file in SharePoint aggiungendo il codice fornitore appropriato è poi si cambia lo stato del file da **Non riuscito** a **Pronto** nella sezione **Registri delle origini per il formato di importazione**, è possibile importare il file nuovamente.</span><span class="sxs-lookup"><span data-stu-id="854f3-238">If you fix this file on SharePoint by adding the proper vendor code and then change the status of the file from **Failed** to **Ready** in the **Sources log for the import format** section, you can import the file again.</span></span>

11. <span data-ttu-id="854f3-239">Esaminare la cartella di SharePoint **Origine di importazione dei file (principale)**.</span><span class="sxs-lookup"><span data-stu-id="854f3-239">Review the **Files import source (main)** SharePoint folder.</span></span> <span data-ttu-id="854f3-240">Il file di Excel che non è stato ancora importato è ancora disponibile in questa cartella.</span><span class="sxs-lookup"><span data-stu-id="854f3-240">Notice that the Excel file that wasn't imported is still in this folder.</span></span>
12. <span data-ttu-id="854f3-241">In Finance and Operations, selezionare **Contabilità fornitori** \> **Attività periodiche** \> **Imposta 1099** \> **Liquidazione fornitore per i moduli 1099**, immettere i valori appropriati nei campi **Dal** e **Al** e quindi selezionare **Transazioni 1099 manuali**.</span><span class="sxs-lookup"><span data-stu-id="854f3-241">In Finance and Operations, select **Accounts payable** \> **Periodic tasks** \> **Tax 1099** \> **Vendor settlement for 1099s**, enter appropriate values in the **From date** and **To date** fields, and then select **Manual 1099 transactions**.</span></span>

    <span data-ttu-id="854f3-242">Solo le transazioni per il giustificativo V-00001 sono disponibili.</span><span class="sxs-lookup"><span data-stu-id="854f3-242">Only transactions for voucher V-00001 are available.</span></span> <span data-ttu-id="854f3-243">Non sono presenti transazioni per il giustificativo V-00002 anche se l'errore dell'ultima transazione importata viene trovato nel file di Excel.</span><span class="sxs-lookup"><span data-stu-id="854f3-243">No transactions for voucher V-00002 are available even though the error for the last imported transaction has been found in the Excel file.</span></span>

